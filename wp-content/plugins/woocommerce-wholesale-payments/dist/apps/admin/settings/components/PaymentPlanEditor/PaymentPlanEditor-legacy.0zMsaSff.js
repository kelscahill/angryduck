!function(){const e=["window"];function a(e,a){var l=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);a&&(t=t.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),l.push.apply(l,t)}return l}function l(e){for(var l=1;l<arguments.length;l++){var n=null!=arguments[l]?arguments[l]:{};l%2?a(Object(n),!0).forEach((function(a){t(e,a,n[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))}))}return e}function t(e,a,l){return(a=function(e){var a=function(e,a){if("object"!=typeof e||!e)return e;var l=e[Symbol.toPrimitive];if(void 0!==l){var t=l.call(e,a||"default");if("object"!=typeof t)return t;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===a?String:Number)(e)}(e,"string");return"symbol"==typeof a?a:a+""}(a))in e?Object.defineProperty(e,a,{value:l,enumerable:!0,configurable:!0,writable:!0}):e[a]=l,e}System.register(["../../../../../common/vue.esm-bundler-legacy.WK047frM.js","../../index-legacy.GLF-4Wj-.js","../../../../../common/index-legacy.CrPvcMca.js","../../../../../common/index-legacy.BkUWSDTB.js","../../../../../common/LoadingOutlined-legacy.CZa04zJ1.js","../../../../../common/BreakdownDueLabel.vue_vue_type_script_setup_true_lang-legacy.qgX9KmlI.js","../../../../../common/Modal-legacy.B-iydlEu.js","../../../../../common/axios-legacy.CLDmrO42.js","../../../../../common/index-legacy.CeffEjmd.js","../../../../../common/index-legacy.Dkhj2epY.js","../../../../../common/index-legacy.BnOczZwp.js","../../../../../common/CheckOutlined-legacy.Bld3PYK2.js","../../../../../common/InfoCircleFilled-legacy.DbbXDboB.js","../../../../../common/index-legacy.oEBkF2M2.js","../../../../../common/index-legacy.CNKU15QW.js","../../../../../common/DeleteOutlined-legacy.nbtKPEsB.js","../../../../../common/index-legacy.D7J-n3o4.js","../../../../../common/index-legacy.CrmBmGbE.js","../../../../../common/index-legacy.DdEtKe53.js","../../../../../common/index-legacy.uYXgLjLh.js","../../../../../common/index-legacy.BURBWK5d.js","../../../../../common/_plugin-vue_export-helper-legacy.DgAO6S8O.js","../../../../../common/preload-helper-legacy.TPiD7rVa.js","../../../../../common/zoom-legacy.Ce4eGWkx.js","../../../../../common/Compact-legacy.z-UC5psU.js","../../../../../common/FormItemContext-legacy.DG8rbb71.js","../../../../../common/CloseCircleFilled-legacy.BgOKszxx.js","../../../../../common/index-legacy.CWazPwt-.js","../../../../../common/pickAttrs-legacy.-fBE3o_4.js","../../../../../common/styleChecker-legacy.BhfnSKn7.js","../../../../../common/vnode-legacy.B2MH91DS.js","../../../../../common/RightOutlined-legacy.DqJdbN-H.js","../../../../../common/firstNotUndefined-legacy.C018uCjX.js","../../../../../common/collapseMotion-legacy.BE5dWXDS.js","../../../../../common/ResizeObserver.es-legacy.0iJwNYH9.js","../../../../../common/index-legacy.OizwhMMa.js","../../../../../common/EyeOutlined-legacy.DX4HV6eW.js","../../../../../common/slide-legacy.C5c7CiIf.js","../../../../../common/useFlexGapSupport-legacy.jrsYdGp6.js"],(function(a,t){"use strict";var n,o,i,r,d,c,s,p,u,v,f,m,y,b,h,w,g,x,k,_,j,E,O,P,C,z,T,M,S,L,D,U,N,R,H,I,q,A,B,F,W,G,$,V,J,Q,K,X,Y,Z,ee,ae,le,te,ne;return{setters:[e=>{n=e.a,o=e.N,i=e.O,e.L,e._,e.$,r=e.j,d=e.w,c=e.g,s=e.a0,p=e.S,u=e.u,v=e.z,f=e.R,m=e.d,y=e.l,b=e.m,h=e.B,w=e.C,g=e.q,x=e.x,k=e.F,_=e.D,j=e.G,E=e.E,O=e.a1,P=e.a2},e=>{C=e.u,z=e.a,T=e.e},e=>{M=e.i,S=e.p,L=e.l,D=e.g},e=>{U=e.u},e=>{N=e.I,R=e.s},e=>{H=e._},e=>{I=e.S,q=e.c},e=>{A=e.a},e=>{B=e.a},e=>{F=e.C},e=>{W=e.S},e=>{G=e.C},e=>{$=e.a,V=e.I},e=>{J=e.T},e=>{Q=e.T,K=e.I},e=>{X=e.P,Y=e.D},e=>{Z=e.S},e=>{ee=e.S},e=>{ae=e.B},e=>{le=e.R},e=>{te=e.C},e=>{ne=e._},null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){var t,oe=document.createElement("style");oe.textContent=".ant-select-dropdown{min-width:120px!important;max-width:initial!important;width:initial!important}.wpayment-plan-editor .editor-heading[data-v-f39f1ebc]{font-size:24px;margin-bottom:0;line-height:28.8px}.wpayment-plan-editor .editor-desc[data-v-f39f1ebc]{font-style:italic;font-size:16px;font-weight:400;color:#666}.wpayment-plan-editor .plan-status-switch[data-v-f39f1ebc]{display:flex;gap:20px;margin:24px 0}.wpayment-plan-editor .plan-status-switch label[data-v-f39f1ebc]{font-size:20px;font-weight:600;line-height:24px;color:#333}.wpayment-plan-editor .plan-status-switch .plan-enable-switch[data-v-f39f1ebc]{outline:none}.wpayment-plan-editor .plan-status-switch .plan-enable-switch.ant-switch-checked[data-v-f39f1ebc]{background-color:#17db94}.wpayment-plan-editor .plan-status-switch>div[data-v-f39f1ebc]{display:flex;align-items:center}.wpayment-plan-editor .plan-status-switch>div span[data-v-f39f1ebc]{font-size:16px;line-height:19.2px}.wpayment-plan-editor .apply-restrictions-switch-container[data-v-f39f1ebc]{display:flex;gap:20px;margin:24px 0 32px}.wpayment-plan-editor .apply-restrictions-switch-container label[data-v-f39f1ebc]{font-size:20px;font-weight:600;line-height:24px;color:#333}.wpayment-plan-editor .apply-restrictions-switch-container .apply-restrictions-switch[data-v-f39f1ebc]{outline:none}.wpayment-plan-editor .apply-restrictions-switch-container .apply-restrictions-switch.ant-switch-checked[data-v-f39f1ebc]{background-color:#17db94}.wpayment-plan-editor .apply-restrictions-switch-container>div[data-v-f39f1ebc]{display:flex;align-items:center}.wpayment-plan-editor .apply-restrictions-switch-container>div span[data-v-f39f1ebc]{font-size:16px;line-height:19.2px}.wpayment-plan-editor .apply-auto-charge-switch-container[data-v-f39f1ebc]{display:flex;gap:20px;margin:24px 0 32px}.wpayment-plan-editor .apply-auto-charge-switch-container label[data-v-f39f1ebc]{font-size:20px;font-weight:600;line-height:24px;color:#333}.wpayment-plan-editor .apply-auto-charge-switch-container .apply-auto-charge-switch[data-v-f39f1ebc]{outline:none}.wpayment-plan-editor .apply-auto-charge-switch-container .apply-auto-charge-switch.ant-switch-checked[data-v-f39f1ebc]{background-color:#17db94}.wpayment-plan-editor .apply-auto-charge-switch-container>div[data-v-f39f1ebc]{display:flex;align-items:center}.wpayment-plan-editor .apply-auto-charge-switch-container>div span[data-v-f39f1ebc]{font-size:16px;line-height:19.2px}.wpayment-plan-editor .apply-restriction-fields[data-v-f39f1ebc]{margin-bottom:32px}.wpayment-plan-editor .apply-restriction-fields label[data-v-f39f1ebc]{font-size:16px;font-weight:700}.wpayment-plan-editor .edit-plan-field-label[data-v-f39f1ebc]{margin-bottom:10px;display:flex;align-items:center;margin-top:20px;gap:10px}.wpayment-plan-editor .edit-plan-field-label label[data-v-f39f1ebc]{font-size:16px;line-height:20px;font-weight:600}.wpayment-plan-editor .edit-plan-field-label .ant-tooltip[data-v-f39f1ebc]{cursor:help}.wpayment-plan-editor .payment-plan-details-container textarea[data-v-f39f1ebc]{width:100%;border-color:#d5d4dc;padding:16px 12px;font-size:16px}.wpayment-plan-editor .breakdown-container[data-v-f39f1ebc]{margin-top:40px}.wpayment-plan-editor .breakdown-container>p[data-v-f39f1ebc]{margin-bottom:25px}.wpayment-plan-editor .breakdown-container label[data-v-f39f1ebc]{font-size:20px;font-weight:600;line-height:24px;color:#333}.wpayment-plan-editor .breakdown-container .plan-breakdown-action[data-v-f39f1ebc]{text-align:right}.wpayment-plan-editor .ant-collapse-header-text .plan-breakdown-day[data-v-f39f1ebc]{font-weight:700;font-size:24px;color:#333}.wpayment-plan-editor .ant-collapse-header-text .plan-breakdown-due span[data-v-f39f1ebc]{font-weight:600;font-size:20px;line-height:24px;color:#333}.wpayment-plan-editor .ant-collapse-header-text .plan-breakdown-action>span[data-v-f39f1ebc]{display:flex;align-items:center}.wpayment-plan-editor .ant-collapse-header-text .plan-breakdown-action>span span[data-v-f39f1ebc]{font-weight:600;font-size:16px;line-height:19.2px;color:#333}.wpayment-plan-editor .ant-collapse-header-text .plan-breakdown-action>span:hover span[data-v-f39f1ebc]{color:#d91a1a}.wpayment-plan-editor .ant-collapse-content-box .breakdown-label[data-v-f39f1ebc]{font-size:20px;font-weight:600}.wpayment-plan-editor .add-breakdown-payment[data-v-f39f1ebc]{text-align:center;margin-top:30px;margin-bottom:45px}.wpayment-plan-editor .add-breakdown-payment .add-breakdown-payment-btn[data-v-f39f1ebc]{font-size:24px;border:none;color:#b9b9b9;outline:none;line-height:24px}.wpayment-plan-editor button.form-action-btn[data-v-f39f1ebc]{padding:16px 36px!important;height:auto!important;font-size:20px;font-weight:600;line-height:28px}.wpayment-plan-editor button.form-action-btn.action-btn-success[data-v-f39f1ebc]{background-color:#2bac47;border-color:#2bac47;color:#fff}.wpayment-plan-editor button.form-action-btn.delete[data-v-f39f1ebc]:hover{background-color:#d91a1a;color:#fff;border:1px solid #D91A1A}.wpayment-plan-editor .plan-editor-buttons[data-v-f39f1ebc]{margin-top:70px}.wpayment-plan-editor[data-v-f39f1ebc] .select-role-restrictions,.wpayment-plan-editor[data-v-f39f1ebc] .allowed-users-restriction{width:100%}.wpayment-plan-editor[data-v-f39f1ebc] .select-role-restrictions.ant-select-focused .ant-select-selection-search-input,.wpayment-plan-editor[data-v-f39f1ebc] .allowed-users-restriction.ant-select-focused .ant-select-selection-search-input{box-shadow:none;outline:none}\n/*$vite$:1*/",document.head.appendChild(oe);var ie={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M623.6 316.7C593.6 290.4 554 276 512 276s-81.6 14.5-111.6 40.7C369.2 344 352 380.7 352 420v7.6c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V420c0-44.1 43.1-80 96-80s96 35.9 96 80c0 31.1-22 59.6-56.1 72.7-21.2 8.1-39.2 22.3-52.1 40.9-13.1 19-19.9 41.8-19.9 64.9V620c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8v-22.7a48.3 48.3 0 0130.9-44.8c59-22.7 97.1-74.7 97.1-132.5.1-39.3-17.1-76-48.3-103.3zM472 732a40 40 0 1080 0 40 40 0 10-80 0z"}}]},name:"question-circle",theme:"outlined"};function re(e){for(var a=1;a<arguments.length;a++){var l=null!=arguments[a]?Object(arguments[a]):{},t=Object.keys(l);"function"==typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(l).filter((function(e){return Object.getOwnPropertyDescriptor(l,e).enumerable})))),t.forEach((function(a){de(e,a,l[a])}))}return e}function de(e,a,l){return a in e?Object.defineProperty(e,a,{value:l,enumerable:!0,configurable:!0,writable:!0}):e[a]=l,e}var ce=function(e,a){var l=re({},e,a.attrs);return n(N,re({},l,{icon:ie}),null)};ce.displayName="QuestionCircleOutlined",ce.inheritAttrs=!1;var se={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M696 480H544V328c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v152H328c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h152v152c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V544h152c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8z"}},{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}}]},name:"plus-circle",theme:"outlined"};function pe(e){for(var a=1;a<arguments.length;a++){var l=null!=arguments[a]?Object(arguments[a]):{},t=Object.keys(l);"function"==typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(l).filter((function(e){return Object.getOwnPropertyDescriptor(l,e).enumerable})))),t.forEach((function(a){ue(e,a,l[a])}))}return e}function ue(e,a,l){return a in e?Object.defineProperty(e,a,{value:l,enumerable:!0,configurable:!0,writable:!0}):e[a]=l,e}var ve=function(e,a){var l=pe({},e,a.attrs);return n(N,pe({},l,{icon:se}),null)};function fe(e){return!!o()&&(i(e),!0)}ve.displayName="PlusCircleOutlined",ve.inheritAttrs=!1;const me="undefined"!=typeof window&&"undefined"!=typeof document;"undefined"!=typeof WorkerGlobalScope&&(globalThis,WorkerGlobalScope);const ye=e=>null!=e,be=Object.prototype.toString,he=()=>{};function we(e){return Array.isArray(e)?e:[e]}const ge=me?window:void 0;function xe(e){var a;const l=s(e);return null!=(a=null==l?void 0:l.$el)?a:l}function ke(...e){const a=[],t=()=>{a.forEach((e=>e())),a.length=0},n=c((()=>{const a=we(s(e[0])).filter((e=>null!=e));return a.every((e=>"string"!=typeof e))?a:void 0})),o=(i=([e,n,o,i])=>{if(t(),!(null==e?void 0:e.length)||!(null==n?void 0:n.length)||!(null==o?void 0:o.length))return;const r=(d=i,"[object Object]"===be.call(d)?l({},i):i);var d;a.push(...e.flatMap((e=>n.flatMap((a=>o.map((l=>((e,a,l,t)=>(e.addEventListener(a,l,t),()=>e.removeEventListener(a,l,t)))(e,a,l,r))))))))},d((()=>{var a,l;return[null!=(l=null==(a=n.value)?void 0:a.map((e=>xe(e))))?l:[ge].filter((e=>null!=e)),we(s(n.value?e[1]:e[0])),we(u(n.value?e[2]:e[1])),s(n.value?e[3]:e[2])]}),i,l(l({},{flush:"post"}),{},{immediate:!0})));var i;return fe(t),()=>{o(),t()}}function _e(e){const a=function(){const e=r(!1),a=f();return a&&v((()=>{e.value=!0}),a),e}();return c((()=>(a.value,Boolean(e()))))}function je(a,l,t={}){const{window:n=ge}=t,o=function(e,a){if(null==e)return{};var l,t,n=function(e,a){if(null==e)return{};var l={};for(var t in e)if({}.hasOwnProperty.call(e,t)){if(a.includes(t))continue;l[t]=e[t]}return l}(e,a);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(t=0;t<o.length;t++)l=o[t],a.includes(l)||{}.propertyIsEnumerable.call(e,l)&&(n[l]=e[l])}return n}(t,e);let i;const r=_e((()=>n&&"MutationObserver"in n)),p=()=>{i&&(i.disconnect(),i=void 0)},u=c((()=>{const e=we(s(a)).map(xe).filter(ye);return new Set(e)})),v=d((()=>u.value),(e=>{p(),r.value&&e.size&&(i=new MutationObserver(l),e.forEach((e=>i.observe(e,o))))}),{immediate:!0,flush:"post"}),f=()=>{v(),p()};return fe(f),{isSupported:r,stop:f,takeRecords:()=>null==i?void 0:i.takeRecords()}}function Ee(e,a={}){const{delayEnter:l=0,delayLeave:t=0,triggerOnRemoval:n=!1,window:o=ge}=a,i=r(!1);let d;const s=e=>{const a=e?l:t;d&&(clearTimeout(d),d=void 0),a?d=setTimeout((()=>i.value=e),a):i.value=e};return o?(ke(e,"mouseenter",(()=>s(!0)),{passive:!0}),ke(e,"mouseleave",(()=>s(!1)),{passive:!0}),n&&function(e,a,l={}){const{window:t=ge,document:n=(null==t?void 0:t.document),flush:o="sync"}=l;if(!t||!n)return he;let i;const r=e=>{null==i||i(),i=e},d=p((()=>{const l=xe(e);if(l){const{stop:e}=je(n,(e=>{e.map((e=>[...e.removedNodes])).flat().some((e=>e===l||e.contains(l)))&&a(e)}),{window:t,childList:!0,subtree:!0});r(e)}}),{flush:o}),c=()=>{d(),r()};fe(c)}(c((()=>xe(e))),(()=>s(!1))),i):i}const Oe={mounted(e,a){const l=a.value;if("function"==typeof l){const a=Ee(e);d(a,(e=>l(e)))}else{const[a,t]=l,n=Ee(e,t);d(n,(e=>a(e)))}}};!function(){let e=!1;const a=r(!1)}();const Pe=null!==(t=window.wpayObj)&&void 0!==t&&t.maxRequests?Number(window.wpayObj.maxRequests):8,Ce=Math.floor(1e3/Pe);let ze=0;const Te={class:"wpayment-plan-editor"},Me={class:"editor-heading"},Se={key:1,class:"payment-plan-details-container"},Le={class:"editor-desc"},De={class:"plan-status-switch"},Ue={class:"edit-plan-field-label"},Ne=["innerHTML"],Re={class:"edit-plan-field-label"},He=["innerHTML"],Ie={class:"breakdown-container"},qe={class:"breakdown-label"},Ae=["innerHTML"],Be=["innerHTML"],Fe={class:"breakdown-label"},We=["innerHTML"],Ge={class:"add-breakdown-payment"},$e=["innerHTML"],Ve={class:"apply-restrictions-switch-container"},Je={key:0,class:"apply-restriction-fields"},Qe={class:"edit-plan-field-label"},Ke=["innerHTML"],Xe={class:"edit-plan-field-label"},Ye=["innerHTML"],Ze={key:1,class:"apply-auto-charge-switch-container"},ea={class:"wpay-tw-inline-block wpay-tw-mr-2"},aa={class:"wpay-tw-inline-block wpay-tw-mr-2"};a("default",ne(m({__name:"PaymentPlanEditor",setup(e){const a=U(),{paymentPlan:t}=R(a),o=C(),i=z(),{getQueryArgs:s}=window.wp.url,{sprintf:p}=window.wp.i18n,f=r(!1),m=r(!1),N=r(!1),ne=r(!1),oe=r(!1),ie=r(!0),re=r(""),de=r(""),se=r([]),pe=r([]),ue=r([]),fe=r(""),me=r([]),ye=r(!1),be=r(!1),he=r(!1);let we=u(ie),ge="",xe="",ke=[];const _e=()=>{var e,a,l,n,o,i,r,d,c,s,p,u,v,f,m,y;re.value=null!==(e=null===(a=t.value)||void 0===a?void 0:a.post.post_title)&&void 0!==e?e:"",de.value=null!==(l=null===(n=t.value)||void 0===n?void 0:n.post.post_content)&&void 0!==l?l:"",se.value=null!==(o=null===(i=t.value)||void 0===i?void 0:i.breakdown)&&void 0!==o?o:[],ie.value="yes"===(null===(r=t.value)||void 0===r?void 0:r.enabled),pe.value=window.lodash.isEmpty(null===(d=t.value)||void 0===d?void 0:d.wholesale_roles)?[]:null===(c=t.value)||void 0===c?void 0:c.wholesale_roles,ue.value=window.lodash.isEmpty(null===(s=t.value)||void 0===s?void 0:s.allowed_users)?[]:null===(p=t.value)||void 0===p?void 0:p.allowed_users,be.value="yes"===(null===(u=t.value)||void 0===u?void 0:u.apply_restrictions),he.value="yes"===(null===(v=t.value)||void 0===v?void 0:v.apply_auto_charge),ge=re.value,xe=de.value,ke=[...se.value],fe.value=null!==(f=null===(m=t.value)||void 0===m||null===(m=m.breakdown)||void 0===m||null===(m=m[0])||void 0===m?void 0:m.id)&&void 0!==f?f:"",oe.value=!1,null!==(y=ue.value)&&void 0!==y&&y.length&&ue.value.length>0&&ia(ue.value)};v((()=>{null==t.value&&null!=o.query.edit&&Number.isInteger(Number(o.query.edit))?(f.value=!0,a.getPaymentPlan(o.query.edit).then((e=>{t.value=e.data,_e()})).catch((e=>{B.error({message:M().notice.error,description:S(e.error.message)}),console.log(e)})).finally((()=>{f.value=!1}))):_e()}));const je=()=>{const e=s(L().adminBaseUrl);oe.value?q({title:M().planEditor.notice.unsavedChanges,content:M().planEditor.notice.unsavedChangesDesc,okText:M().planEditor.label.yes,cancelText:M().planEditor.label.no,onOk:()=>{i.push({query:l({},e)})}}):i.push({query:l({},e)})},Ee=c((()=>{if(se.value.some((e=>"fixed"===e.due.type)))return!1;return!(se.value.reduce(((e,a)=>"percentage"===a.due.type?e+Number(a.due.value):e),0)<100)})),la=()=>{const e={id:D(),day:se.value.length<1?"0":String(se.value.reduce(((e,a)=>isNaN(a.day)&&null!=(null==a?void 0:a.day_display)?e+Number(null==a?void 0:a.day_display):e+Number(a.day)),0)+30),day_format:"day",due:{type:"fixed",value:0},payment_reminder:{enabled:!1,day:1},overdue_reminder:{enabled:!1,day:1}};se.value.push(e),fe.value=e.id},ta=()=>{var e,n,r,d;const c={set_status:"no",title:re.value,description:de.value,breakdown:se.value,enabled:ie.value?"yes":"no",wholesale_roles:null!==(e=pe.value)&&void 0!==e?e:[],allowed_users:null!==(n=ue.value)&&void 0!==n?n:[],apply_restrictions:be.value?"yes":"no",apply_auto_charge:he.value?"yes":"no"},p=null!==(r=null===(d=t.value)||void 0===d?void 0:d.post.ID)&&void 0!==r?r:"";m.value=!0,a.savePaymentPlan(c,p).then((e=>{B.success({message:M().notice.success,description:S(e.data.message)}),oe.value=!1,"new"===o.query.edit&&(t.value=e.data.plan,i.push({query:l(l({},s(L().adminBaseUrl)),{},{edit:e.data.plan.post.ID}),replace:!0}))})).catch((e=>{B.error({message:M().notice.error,description:S(e.error.message)}),console.log(e)})).finally((()=>{m.value=!1}))},na=e=>{ne.value=e&&Ee.value},oa=()=>{var e;const n=null===(e=t.value)||void 0===e?void 0:e.post.ID;N.value=!0,a.deletePaymentPlan(n).then((e=>{B.success({message:M().notice.success,description:S(e.data.message)}),i.push({query:l({},s(L().adminBaseUrl))})})).catch((e=>{B.error({message:M().notice.error,description:S(e.error.message)}),console.log(e)})).finally((()=>{N.value=!1}))},ia=e=>{let a={_fields:"id,name,display_name",search:"",include:""};a=l(l({},a),{},"string"==typeof e?{search:e}:{include:e.join(",")}),ye.value=!0,((e={},a={})=>{const t=a.maxRequests||Pe,n=a.intervalInMs||Ce,o=A.create(l({timeout:3e4,responseType:"json",headers:{"Content-Type":"application/json;charset=UTF-8","X-WP-Nonce":window.wpayObj.wpNonce,Nonce:window.wpayObj.wcNonce},baseURL:window.wpayObj.usersApiUrl},e));return o.interceptors.request.use((e=>new Promise((a=>{let l=setInterval((()=>{ze<t&&(ze++,clearInterval(l),a(e))}),n)})))),o.interceptors.response.use((e=>(ze=Math.max(0,ze-1),Promise.resolve(e))),(e=>(ze=Math.max(0,ze-1),Promise.reject({error:e.response.data})))),o})().get("/",{params:a}).then((e=>{me.value=e.data.map((e=>({label:e.display_name,value:e.id,key:e.id})))})).catch((e=>{B.error({message:M().notice.error,description:S(e.error.message)}),console.log(e)})).finally((()=>{ye.value=!1}))},ra=window.lodash.debounce(ia,500),da=F.Panel;return d([()=>ie.value,()=>re.value,()=>de.value,()=>se.value],(([e,a,l,t])=>{e!==we||a!==ge||l!==xe||JSON.stringify(t)!==JSON.stringify(ke)?oe.value=!0:oe.value=!1}),{deep:!0}),(e,a)=>{var l;return y(),b("div",Te,[h("h3",Me,w(u(M)().heading.editPaymentPlan.label),1),f.value?(y(),g(u(W),{key:0,active:!0,title:!1,paragraph:{rows:3,width:["90%","90%","90%"]}})):u(t)||"new"===(null===(l=u(o).query)||void 0===l?void 0:l.edit)?(y(),b("div",Se,[h("p",Le,w(u(M)().heading.editPaymentPlan.desc),1),h("div",De,[h("label",null,w(u(M)().planEditor.label.planEnabled),1),h("div",null,[n(u(I),{checked:ie.value,"onUpdate:checked":a[0]||(a[0]=e=>ie.value=e),class:"plan-enable-switch"},{checkedChildren:x((()=>[n(u(G))])),unCheckedChildren:x((()=>[n(u($))])),_:1},8,["checked"]),h("span",null,"  "+w(u(M)().planEditor.input.enabled),1)])]),h("div",Ue,[h("label",null,w(u(M)().planEditor.label.planName),1),n(u(J),{placement:"topLeft"},{title:x((()=>[h("span",{innerHTML:u(S)(u(M)().planEditor.label.planNameTooltip)},null,8,Ne)])),default:x((()=>[n(u(V))])),_:1})]),n(u(Q),{value:re.value,"onUpdate:value":a[1]||(a[1]=e=>re.value=e),placeholder:u(M)().planEditor.placeholder.planName},null,8,["value","placeholder"]),h("div",Re,[h("label",null,w(u(M)().planEditor.label.planDesc),1),n(u(J),{placement:"topLeft"},{title:x((()=>[h("span",{innerHTML:u(S)(u(M)().planEditor.label.planDescTooltip)},null,8,He)])),default:x((()=>[n(u(V))])),_:1})]),n(u(Q),{value:de.value,"onUpdate:value":a[2]||(a[2]=e=>de.value=e),placeholder:u(M)().planEditor.placeholder.planDesc,"auto-size":{minRows:3,maxRows:10}},null,8,["value","placeholder"]),h("p",null,[h("strong",null,w(u(M)().planEditor.desc.planDesc),1)]),h("div",Ie,[h("p",null,[h("label",null,w(u(M)().planEditor.label.planBreakdown),1)]),n(u(F),{"active-key":fe.value,"onUpdate:activeKey":a[3]||(a[3]=e=>fe.value=e),bordered:!1},{default:x((()=>[(y(!0),b(k,null,_(se.value,((e,a)=>(y(),g(u(da),{key:e.id},{header:x((()=>[n(u(le),null,{default:x((()=>[n(u(te),{span:"6",class:"plan-breakdown-day"},{default:x((()=>["timestamp"===(null==e?void 0:e.day_format)?(y(),b(k,{key:0},[j(w(e.day_display),1)],64)):null!=e&&e.day_display?(y(),b(k,{key:1},[j(w(u(M)().planEditor.label.day.replace("%d",null==e?void 0:e.day_display)),1)],64)):(y(),b(k,{key:2},[j(w(u(M)().planEditor.label.day.replace("%d",e.day)),1)],64))])),_:2},1024),n(u(te),{span:"14",class:"plan-breakdown-due"},{default:x((()=>[n(H,{due:e.due},null,8,["due"])])),_:2},1024),n(u(te),{span:"4",class:"plan-breakdown-action"},{default:x((()=>[n(u(X),{title:u(M)().planEditor.notice.deleteBreakdown,onConfirm:e=>(e=>{se.value.splice(e,1)})(a),"ok-text":u(M)().planEditor.label.yes,"cancel-text":u(M)().planEditor.label.no},{default:x((()=>[n(u($)),h("span",null,"  "+w(u(M)().planEditor.label.planDeleteBreakdown),1)])),_:2},1032,["title","onConfirm","ok-text","cancel-text"])])),_:2},1024)])),_:2},1024)])),default:x((()=>[n(u(le),{gutter:8,align:"middle"},{default:x((()=>[n(u(te),{span:"6",class:"label"},{default:x((()=>[h("p",qe,w(u(M)().planEditor.label.breakdown.dayAfterOrder),1)])),_:2},1024),n(u(te),{span:"6",class:"input"},{default:x((()=>[n(u(K),{value:e.day,"onUpdate:value":a=>e.day=a,placeholder:u(M)().planEditor.placeholder.day.replace("%d",e.day),class:"breakdown-input"},null,8,["value","onUpdate:value","placeholder"])])),_:2},1024),n(u(te),{span:"12"},{default:x((()=>[u(L)().enabledAdvDueDays?(y(),g(u(Z),{key:0},{default:x((()=>[n(u(ee),{value:e.day_format,"onUpdate:value":a=>e.day_format=a,placeholder:u(M)().planEditor.label.selectFormat,options:[{label:u(M)().planEditor.input.day,value:"day"},{label:u(M)().planEditor.input.custom,value:"custom"},{label:u(M)().planEditor.input.timestamp,value:"timestamp"}],class:"breakdown-select"},null,8,["value","onUpdate:value","placeholder","options"]),["custom","timestamp"].includes(e.day_format)&&!u(window.lodash.isEmpty)(e.day)?(y(),g(u(J),{key:0,placement:"right"},{title:x((()=>["custom"===e.day_format?(y(),b("span",{key:0,innerHTML:u(S)(u(p)(u(M)().planEditor.desc.customDesc,e.day))},null,8,Ae)):"timestamp"===e.day_format?(y(),b("span",{key:1,innerHTML:u(S)(u(p)(u(M)().planEditor.desc.timestampDesc,e.day))},null,8,Be)):E("",!0)])),default:x((()=>[n(u(ce))])),_:2},1024)):E("",!0)])),_:2},1024)):E("",!0)])),_:2},1024)])),_:2},1024),n(u(le),{gutter:8,align:"middle"},{default:x((()=>[n(u(te),{span:"6",class:"label"},{default:x((()=>[h("p",Fe,w(u(M)().planEditor.label.breakdown.amountDue),1)])),_:2},1024),n(u(te),{span:"6",class:"input"},{default:x((()=>[n(u(ee),{value:e.due.type,"onUpdate:value":a=>e.due.type=a,options:[{label:u(M)().planEditor.input.fixed,value:"fixed"},{label:u(M)().planEditor.input.percentage,value:"percentage"},{label:u(M)().planEditor.input.none,value:"none"}],class:"breakdown-select"},null,8,["value","onUpdate:value","options"])])),_:2},1024),n(u(te),{span:"12",class:"label"})])),_:2},1024),n(u(le),{gutter:8,align:"middle"},{default:x((()=>[n(u(te),{offset:"6",span:"6",class:"input"},{default:x((()=>["fixed"===e.due.type||"percentage"===e.due.type?(y(),g(u(K),{key:0,value:e.due.value,"onUpdate:value":a=>e.due.value=a,placeholder:u(M)().planEditor.placeholder.amountDue,class:"wpay-tw-w-[9.8rem] breakdown-input-group","addon-after":"percentage"===e.due.type?"%":""},O({_:2},["fixed"===e.due.type?{name:"addonBefore",fn:x((()=>[h("span",{innerHTML:u(S)(u(L)().currencySymbol)},null,8,We)])),key:"0"}:void 0]),1032,["value","onUpdate:value","placeholder","addon-after"])):E("",!0)])),_:2},1024),n(u(te),{span:"12",class:"label"})])),_:2},1024)])),_:2},1024)))),128))])),_:1},8,["active-key"])]),h("p",Ge,[P((y(),g(u(ae),{class:"add-breakdown-payment-btn",disabled:Ee.value,onClick:la,type:"link",size:"large"},{default:x((()=>[n(u(ve)),j(" "+w(u(M)().planEditor.button.addPayment)+" ",1),n(u(J),{open:ne.value,placement:"right"},{title:x((()=>[h("span",{innerHTML:u(S)(u(M)().planEditor.desc.noAddlPayment)},null,8,$e)])),_:1},8,["open"])])),_:1},8,["disabled"])),[[u(Oe),na]])]),h("div",Ve,[h("label",null,w(u(M)().planEditor.label.applyRestrictions),1),h("div",null,[n(u(I),{checked:be.value,"onUpdate:checked":a[4]||(a[4]=e=>be.value=e),class:"apply-restrictions-switch"},{checkedChildren:x((()=>[n(u(G))])),unCheckedChildren:x((()=>[n(u($))])),_:1},8,["checked"]),h("span",null,"  "+w(u(M)().planEditor.input.enabled),1)])]),be.value?(y(),b("div",Je,[h("div",Qe,[h("label",null,w(u(M)().planEditor.label.allowedWsRoles),1),n(u(J),{placement:"topLeft"},{title:x((()=>[h("span",{innerHTML:u(S)(u(M)().planEditor.label.allowedWsRolesToolTip)},null,8,Ke)])),default:x((()=>[n(u(V))])),_:1})]),h("p",null,[n(u(ee),{value:pe.value,"onUpdate:value":a[5]||(a[5]=e=>pe.value=e),class:"select-role-restrictions",mode:"multiple",placeholder:u(M)().planEditor.placeholder.selectRoleRestrictions,options:u(L)().wholesaleRoles},null,8,["value","placeholder","options"])]),h("div",Xe,[h("label",null,w(u(M)().planEditor.label.allowedUsers),1),n(u(J),{placement:"topLeft"},{title:x((()=>[h("span",{innerHTML:u(S)(u(M)().planEditor.label.allowedUsersToolTip)},null,8,Ye)])),default:x((()=>[n(u(V))])),_:1})]),h("p",null,[n(u(ee),{value:ue.value,"onUpdate:value":a[6]||(a[6]=e=>ue.value=e),class:"allowed-users-restriction",mode:"multiple",placeholder:u(M)().planEditor.placeholder.selectAllowedUsers,options:me.value,"not-found-content":ye.value?void 0:null,"filter-option":!1,"show-search":"","allow-clear":"",onSearch:u(ra)},O({_:2},[ye.value?{name:"notFoundContent",fn:x((()=>[n(T)])),key:"0"}:void 0]),1032,["value","placeholder","options","not-found-content","onSearch"])])])):E("",!0),u(L)().autoChargeInvoices?(y(),b("div",Ze,[h("label",null,w(u(M)().planEditor.label.applyAutoCharge),1),h("div",null,[n(u(I),{checked:he.value,"onUpdate:checked":a[7]||(a[7]=e=>he.value=e),class:"apply-auto-charge-switch"},{checkedChildren:x((()=>[n(u(G))])),unCheckedChildren:x((()=>[n(u($))])),_:1},8,["checked"]),h("span",null,"  "+w(u(M)().planEditor.input.enabled),1)])])):E("",!0),n(u(le),{align:"middle",class:"plan-editor-buttons"},{default:x((()=>[n(u(te),{span:"12"},{default:x((()=>[n(u(Z),null,{default:x((()=>[n(u(ae),{type:"primary",disabled:m.value,onClick:ta,size:"large",class:"form-action-btn action-btn-success"},{default:x((()=>[h("span",ea,w(u(M)().planEditor.button.savePaymentPlan),1),m.value?(y(),g(T,{key:0,class:"wpay-tw-text-white"})):E("",!0)])),_:1},8,["disabled"]),oe.value?(y(),g(u(ae),{key:0,onClick:je,size:"large",class:"form-action-btn action-btn-default"},{default:x((()=>[j(w(u(M)().button.cancel),1)])),_:1})):(y(),g(u(ae),{key:1,onClick:je,size:"large",class:"form-action-btn action-btn-default"},{default:x((()=>[j(w(u(M)().planEditor.button.cancelPaymentPlan),1)])),_:1}))])),_:1})])),_:1}),n(u(te),{offset:"4",span:"8",align:"right"},{default:x((()=>{var e;return[null!=(null===(e=u(t))||void 0===e||null===(e=e.post)||void 0===e?void 0:e.ID)?(y(),g(u(X),{key:0,title:u(M)().planEditor.notice.deletePlan,onConfirm:oa,"ok-text":u(M)().planEditor.label.yes,"cancel-text":u(M)().planEditor.label.no},{default:x((()=>[n(u(ae),{size:"large",class:"wpay-tw-text-red-600 form-action-btn action-btn-default delete"},{default:x((()=>[n(u(Y)),h("span",aa,w(u(M)().planEditor.button.deletePlan),1),N.value?(y(),g(T,{key:0})):E("",!0)])),_:1})])),_:1},8,["title","ok-text","cancel-text"])):E("",!0)]})),_:1})])),_:1})])):E("",!0)])}}}),[["__scopeId","data-v-f39f1ebc"]]))}}}))}();
