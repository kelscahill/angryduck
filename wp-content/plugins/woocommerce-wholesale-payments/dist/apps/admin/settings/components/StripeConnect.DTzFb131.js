import{d as N,j as f,l as u,m as h,B as o,C as n,u as e,a as r,x as l,G as c,q as B,Y as O,a1 as D,E,F as K}from"../../../../common/vue.esm-bundler.Eb_t0ZuK.js";import{l as i,i as t,p as P}from"../../../../common/index.ln50ek6N.js";import{e as R,S as V,c as z}from"../../../../common/Modal.CTSvrbAV.js";import{r as _}from"../../../../common/rymeraStripeApi.BfXVHAlT.js";import{e as H}from"../index.DsLwCX30.js";import{B as w}from"../../../../common/index.DO4rv7yP.js";import{C as m}from"../../../../common/CheckOutlined.2I5Jb425.js";import{S as L}from"../../../../common/index.salE0Mpj.js";import{a as d}from"../../../../common/index.BWmZUCTt.js";import{E as j}from"../../../../common/InfoCircleFilled.CuIgY0ZM.js";import{C as q}from"../../../../common/index.DyDRXpIC.js";import{T as F}from"../../../../common/index.CugMjDrc.js";import{R as W}from"../../../../common/index.CirbKzNG.js";import{_ as $}from"../../../../common/_plugin-vue_export-helper.DlAUqK2U.js";import"../../../../common/LoadingOutlined.BwWHly1W.js";import"../../../../common/zoom._5t9uMJA.js";import"../../../../common/Compact.BekGZffk.js";import"../../../../common/FormItemContext.kpf8ZKmg.js";import"../../../../common/CloseCircleFilled.DLp4Uax1.js";import"../../../../common/index.wAr7hMel.js";import"../../../../common/pickAttrs.CO1oKgar.js";import"../../../../common/styleChecker.Cz-BSt7T.js";import"../../../../common/vnode.CxjOFO7d.js";import"../../../../common/axios.Ce6w_M6R.js";import"../../../../common/preload-helper.03U_i1H8.js";import"../../../../common/useFlexGapSupport.DGl5WWhP.js";import"../../../../common/ResizeObserver.es.B1PUzC5B.js";import"../../../../common/firstNotUndefined.CLFzEa0p.js";const G={key:0},I={key:2,class:"form-table"},U={scope:"row"},Y=["innerHTML"],J={scope:"row"},Q={scope:"row"},X={scope:"row"},Z={scope:"row"},ee={scope:"row"},te={key:0},oe={scope:"row",colspan:"2"},se=N({__name:"StripeConnect",setup(ne){var v;const a=f(!1),y=f(!1),k=f(i().apiMode==="test"),g=f(!1),{sprintf:C}=window.wp.i18n,A=()=>{a.value=!0,_().post("connect").then(({data:s})=>{y.value=!0;const{onboarding_url:p}=s;window.location.href=p}).catch(s=>{d.error({message:t().notice.error,description:s.error.message,class:"wpay-error-notification"})}).finally(()=>{a.value=!1})},M=()=>{a.value=!0,_().get("account",{params:{account_number:i().accountNumber}}).then(({data:s})=>{d.success({message:t().notice.success,description:s.message,class:"wpay-success-notification"})}).catch(s=>{s.error.message.includes("account does not exist")||s.error.message.includes("may have been revoked")||s.error.message.includes("not found")?(d.error({message:t().notice.error,description:t().notice.stripeAccountNotLinked,class:"wpay-error-notification"}),setTimeout(()=>{window.location.reload()},2e3)):d.error({message:t().notice.error,description:s.error.message,class:"wpay-error-notification"})}).finally(()=>{a.value=!1})},T=()=>{z({title:t().notice.confirmAction,content:t().notice.stripeResetWarning,icon:r(j),onOk(){_().post("connect/reset").then(({data:s})=>{d.success({message:t().notice.success,description:s.message,class:"wpay-success-notification"}),setTimeout(()=>{window.location.reload()},2e3)}).catch(s=>{d.error({message:t().notice.error,description:s.error.message,class:"wpay-error-notification"})})}})},S=s=>{const p=s?"test":"live";g.value=!0,_().post("connect/mode",{which:p}).catch(b=>{d.error({message:t().notice.error,description:b.error.message,class:"wpay-error-notification"})}).finally(()=>{g.value=!1})};(v=i())!=null&&v.errorMessage&&R({title:t().notice.error,content:i().errorMessage});const x=C(t().notice.disabledApiMode,'<code class="wpay-tw-text-orange-200">',"</code>");return(s,p)=>(u(),h(K,null,[o("h3",null,n(e(t)().heading.stripeApiSettings),1),r(e(W),null,{default:l(()=>[r(e(q),null,{default:l(()=>[y.value?(u(),h("p",G,[c(n(e(t)().notice.redirectingToOnboarding)+" ",1),r(H)])):e(i)().accountNumber?(u(),h("table",I,[o("tr",null,[o("th",U,n(e(t)().button.apiMode),1),o("td",null,[r(e(F),{placement:"right"},D({default:l(()=>[r(e(V),{checked:k.value,"onUpdate:checked":p[0]||(p[0]=b=>k.value=b),"checked-children":e(t)().button.testMode,"un-checked-children":e(t)().button.liveMode,class:"wpay-stripe-mode",disabled:e(i)().apiModeDisabled,onChange:S,loading:g.value},null,8,["checked","checked-children","un-checked-children","disabled","loading"])]),_:2},[e(i)().apiModeDisabled?{name:"title",fn:l(()=>[o("span",{innerHTML:e(P)(e(x))},null,8,Y)]),key:"0"}:void 0]),1024)])]),o("tr",null,[o("th",J,n(e(t)().stripe.connected),1),o("td",null,[c(n(e(i)().accountNumber)+" ",1),r(e(m),{style:{color:"#00A32A"}})])]),o("tr",null,[o("th",Q,n(e(t)().stripe.liveAccessToken),1),o("td",null,[c(n(e(i)().liveAccessToken)+" ",1),r(e(m),{style:{color:"#00A32A"}})])]),o("tr",null,[o("th",X,n(e(t)().stripe.livePublishableKey),1),o("td",null,[c(n(e(i)().livePublishableKey)+" ",1),r(e(m),{style:{color:"#00A32A"}})])]),o("tr",null,[o("th",Z,n(e(t)().stripe.testAccessToken),1),o("td",null,[c(n(e(i)().testAccessToken)+" ",1),r(e(m),{style:{color:"#00A32A"}})])]),o("tr",null,[o("th",ee,n(e(t)().stripe.testPublishableKey),1),o("td",null,[c(n(e(i)().testPublishableKey)+" ",1),r(e(m),{style:{color:"#00A32A"}})])]),e(i)().accountNumber?(u(),h("tr",te,[o("th",oe,[r(e(L),null,{default:l(()=>[r(e(w),{size:"small",onClick:M},{default:l(()=>[c(n(a.value?e(t)().button.testingConnection:e(t)().button.testConnection),1)]),_:1}),r(e(w),{size:"small",class:"wpay-tw-text-red-500",onClick:T},{default:l(()=>[c(n(e(t)().button.resetConnection),1)]),_:1})]),_:1})])])):E("",!0)])):(u(),B(e(w),{key:1,class:O("stripe-connect-btn".concat(a.value?" connecting":"")),disabled:a.value,onClick:A},{default:l(()=>[c(n(a.value?e(t)().button.connecting:e(t)().button.connectWithStripe),1)]),_:1},8,["class","disabled"]))]),_:1})]),_:1})],64))}}),Ee=$(se,[["__scopeId","data-v-f1ba3f00"]]);export{Ee as default};
