import{d as O,i as j,G as B,c as D,o as r,k as F,l as N,f as y,N as g,K as T,L as q,J as d,u as m,O as H}from"./LoadingOutlined.BFkAxzyV.js";import{u as L,c as i,X as C,b as S,p as U,Y as z}from"./index.Ith4SzXf.js";import{C as A}from"./currency-context.C3AYz1z8.js";import{T as M}from"./index.BuOrcqbC.js";const V=["innerHTML"],K=O({__name:"QuantityBasedPricingTable",props:{product:{}},setup(_){const f=j("$window"),k=L(),{isCardFormat:v}=B(k),x=[{title:i("quantity",wp.i18n.__("Quantity","woocommerce-wholesale-order-form")),dataIndex:"discountTableQty",key:"discountTableQty",class:"discount-table-qty",customCell:()=>({"data-label":i("quantity",wp.i18n.__("Quantity","woocommerce-wholesale-order-form"))})},{title:i("price",wp.i18n.__("Price","woocommerce-wholesale-order-form")),dataIndex:"discountTablePrice",key:"discountTablePrice",class:"discount-table-price",customCell:()=>({"data-label":i("price",wp.i18n.__("Price","woocommerce-wholesale-order-form"))})},{title:i("save",wp.i18n.__("Save","woocommerce-wholesale-order-form")),dataIndex:"discountTableSave",key:"discountTableSave",class:"discount-table-save",customCell:()=>({"data-label":i("save",wp.i18n.__("Save","woocommerce-wholesale-order-form"))})}],P=D(()=>{var e,t,n,a,u,c,p,w,b;if(((e=_.product)==null?void 0:e.type)==="variable"){const s=C(_.product).value;if(((t=s==null?void 0:s.wholesale_data)==null?void 0:t.wwpp_enable_quantity_discount_rule)==="yes"&&((u=(a=(n=s==null?void 0:s.wholesale_data)==null?void 0:n.wwpp_quantity_discount_rule_mapping)==null?void 0:a.mapping)==null?void 0:u.length)>0)return s.wholesale_data.wwpp_quantity_discount_rule_mapping.mapping.reduce((l,o)=>{var h;return(o==null?void 0:o.wholesale_role)===((h=window.wwofObj)==null?void 0:h.appUser)&&l.push({...o,key:o.wholesale_role}),l},[])}return(b=(w=(p=(c=_.product)==null?void 0:c.wholesale_data)==null?void 0:p.wwpp_quantity_discount_rule_mapping)==null?void 0:w.mapping)==null?void 0:b.reduce((s,l)=>{var o;return(l==null?void 0:l.wholesale_role)===((o=S())==null?void 0:o.appUser)&&s.push({...l,key:l.wholesale_role}),s},[])}),I=e=>{let t=(e==null?void 0:e.start_qty)!==""?e.start_qty:"";return(e==null?void 0:e.end_qty)!==""?t+=" - "+(e==null?void 0:e.end_qty):t+="+",t},Q=e=>{var u,c,p,w;const t=A({symbol:"",precision:f.wwofObj.wcSettings.currency.numDecimals,decimalSeparator:f.wwofObj.wcSettings.currency.decimalSeparator}),n=(w=(c=(u=C(_.product).value)==null?void 0:u.wholesale_data)==null?void 0:c.wholesale_price)==null?void 0:w[(p=S())==null?void 0:p.appUser];let a;return e!=null&&e.wholesale_discount?a=e.wholesale_discount:(e==null?void 0:e.price_type)==="percent-price"?a=t.formatAmount(e==null?void 0:e.wholesale_price):a=t.formatAmount(100-Number(e==null?void 0:e.wholesale_price)/n*100),a+"%"};return(e,t)=>(r(),F(m(M),{columns:x,"data-source":P.value,"page-size":20,pagination:!1,class:H("quantity-based-pricing-table"+(m(v)?"-card":"")),"get-popup-container":m(z)},{bodyCell:N(({column:n,record:a})=>[n.dataIndex==="discountTableQty"?(r(),y(g,{key:0},[T(q(I(a)),1)],64)):d("",!0),n.dataIndex==="discountTablePrice"?(r(),y("span",{key:1,innerHTML:m(U)(a==null?void 0:a.calculated_price)},null,8,V)):d("",!0),n.dataIndex==="discountTableSave"?(r(),y(g,{key:2},[T(q(Q(a)),1)],64)):d("",!0)]),_:1},8,["data-source","class","get-popup-container"]))}});export{K as _};
