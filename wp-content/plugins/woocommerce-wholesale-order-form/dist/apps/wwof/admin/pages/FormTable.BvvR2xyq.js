import{d as Y,G as H,i as Q,b as D,c,u as o,e as W,o as m,f as q,M as d,k as i,L as l,g as w,l as s,K as u,au as J,J as n,N as U,h as C}from"../../../../common/LoadingOutlined.BFkAxzyV.js";import{c as x}from"../../../../common/Modal.CpVgfy99.js";import X from"../components/FormTable/Columns/ShortcodeColumn.KBNT-Ktl.js";import{_ as Z}from"../../../../common/LocationsColumn.vue_vue_type_script_setup_true_lang.XyD28Fgz.js";import{_ as oo}from"../../../../common/StatusColumn.vue_vue_type_script_setup_true_lang.ysVGRzkE.js";import eo from"../components/FormTable/Columns/ActionColumn.D352wlF8.js";import{h as to,c as e,j as b,b as V,p as ro,E as I,B as v}from"../../../../common/index.Ith4SzXf.js";import{B as g}from"../../../../common/index.Bdw1ik1L.js";import{S as ao}from"../../../../common/index.C08f97vy.js";import{R as so,C as T}from"../../../../common/index.D3Qmjxc3.js";import{T as mo}from"../../../../common/index.DuHmgJ7E.js";import{T as io}from"../../../../common/index.BuOrcqbC.js";import"../../../../common/index.Dui4U8Hg.js";import"../../../../common/KeyCode.B_gOgbN6.js";import"../../../../common/omit.DTkbSo29.js";import"../../../../common/pickAttrs.GzdKbNmm.js";import"../../../../common/initDefaultProps.0LfrQis0.js";import"../../../../common/ExclamationCircleFilled.CrW3q_TN.js";import"../../../../common/PortalWrapper.BCGj8rtm.js";import"../../../../common/raf.Deuc0E8-.js";import"../../../../common/motion.WGHlFb5s.js";import"../../../../common/vnode.BC_D2aP8.js";import"../../../../common/isVisible.BHYmLg1T.js";import"../../../../common/ResizeObserver.es.B1PUzC5B.js";import"../../../../common/_getTag.CiIQqq4n.js";import"../../../../common/styleChecker.BhhSW-4N.js";import"../../../../common/index.BVxneXNm.js";import"../../../../common/firstNotUndefined.CLFzEa0p.js";import"../../../../common/colors.Do-YmLJ0.js";import"../../../../common/ActionButton.CECSKzhY.js";import"../../../../common/useDestroyed.puOwgd-l.js";import"../../../../common/index.D0XQRXoo.js";import"../../../../common/_commonjsHelpers.BosuxZz1.js";import"../../../../common/index.lxr2aJRu.js";import"../../../../common/FormItemContext.CuFDkfIX.js";import"../../../../common/createContext.DiHI9yzd.js";import"../../../../common/statusUtils.DES_qYlM.js";import"../../../../common/BaseInput.C6Ke7hb1.js";import"../../../../common/Compact.bO-KmQeW.js";import"../../../../common/index.CUGsZk5V.js";import"../../../../common/compact-item.Be3L5ggo.js";import"../../../../common/SearchOutlined.K2PZqdQC.js";import"../../../../common/isPlainObject.DIpfZ0jz.js";import"../../../../common/_plugin-vue_export-helper.DlAUqK2U.js";import"../../../../common/index.DjkvlaSA.js";import"../../../../common/useState.L1hofs5h.js";import"../../../../common/devWarning.BVoSASTV.js";import"../../../../common/warning.CrM1WiW4.js";import"../../../../common/index.B2U_dx8i.js";import"../../../../common/DeleteOutlined.DS1yXUts.js";import"../../../../common/useFlexGapSupport.BqBlA3Mn.js";import"../../../../common/Col.C48UZKBg.js";import"../../../../common/responsiveObserve.BxgVt-aQ.js";import"../../../../common/eagerComputed.Bhszqfqe.js";import"../../../../common/collapseMotion.CnwYBKtm.js";import"../../../../common/index.CjASPO7n.js";import"../../../../common/index.D28aorQO.js";import"../../../../common/LeftOutlined.Hqnl-2Tc.js";import"../../../../common/RightOutlined.TiLRDrc6.js";import"../../../../common/index.BGHkQlAe.js";import"../../../../common/slide.DZmo5x4X.js";import"../../../../common/isMobile.BbN7I0i_.js";import"../../../../common/useMergedState.DXdtLiCT.js";import"../../../../common/DownOutlined.Bgw7W-Qg.js";import"../../../../common/move.iWCDh3n7.js";import"../../../../common/useBreakpoint.S--6DhMF.js";import"../../../../common/index.FTpNJ4uu.js";import"../../../../common/index.BYshCuJZ.js";import"../../../../common/index.RfEH1ihW.js";import"../../../../common/Checkbox.CYa6__iO.js";import"../../../../common/dropdown.CDjBCMOf.js";import"../../../../common/index.0mGPX0wK.js";import"../../../../common/_arrayIncludes.B8uzE354.js";import"../../../../common/injectionKey.DGYNie3Z.js";import"../../../../common/index.gaSFaOg8.js";import"../../../../common/CaretUpOutlined.BBnMPvd9.js";import"../../../../common/debounce.C88Ko_T_.js";const no=["innerHTML"],lo={class:"list-table-action-btns wwof-tw-my-1"},co={class:"notice notice-info"},wo={class:"wwof-tw-text-lg wwof-tw-font-semibold"},Ee=Y({__name:"FormTable",setup(po){const r=to(),{migratingV2FormStatus:N,deleteV2FormStatus:P}=H(r),y=Q("$window"),O=wp.i18n.sprintf(e("orderFormTableDesc",wp.i18n.__("Below is a list of all the order forms for displaying products that you have on your store. Click each form to edit it's settings or add a new form using the %1$sAdd Form%2$s button below. Forms can be placed on pages via the given shortcode or via an editor block. Forms can be reused on multiple pages and you can also query what pages each form appears on.","woocommerce-wholesale-order-form")),"<code>","</code>");let f=D([]);const S=()=>{const t=f.value.length;x({title:e("deleteFormConfirm",wp.i18n._n("Are you sure you want to delete this form?","Are you sure you want to delete these forms?",t,"woocommerce-wholesale-order-form")),icon:C(I),centered:!0,onOk(){r.deleteForm(o(f)).then(a=>{const{data:_}=a;(_==null?void 0:_.deleted)!=null&&v.success({message:e("nFormsDeleted",wp.i18n._n("Form deleted","Forms deleted",t,"woocommerce-wholesale-order-form")),description:e("nFormsDeletedDesc",wp.i18n._n("Your form was successfully deleted.","Your forms were successfully deleted.",t,"woocommerce-wholesale-order-form")),class:"wwof-success-notification",duration:2,onClose:()=>{y.location.reload()}})})},okText:e("okCaps",wp.i18n.__("OK","woocommerce-wholesale-order-form")),cancelText:e("cancel",wp.i18n.__("Cancel","woocommerce-wholesale-order-form"))})},B=c(()=>N.value===b.PENDING?e("migrating",wp.i18n.__("Migrating...","woocommerce-wholesale-order-form")):e("migrateV2Data",wp.i18n.__("Migrate V2 Form Data","woocommerce-wholesale-order-form"))),L=()=>{r.migrateV2Form().then(t=>{v.success({message:e("migrated",wp.i18n.__("Migrated","woocommerce-wholesale-order-form")),description:t.data.message,class:"wwof-success-notification",duration:2,onClose:()=>{y.location.reload()}})})},A=c(()=>P.value===b.PENDING?e("deleting",wp.i18n.__("Deleting...","woocommerce-wholesale-order-form")):e("deleteV2FormData",wp.i18n.__("Cleanup Old Form Data","woocommerce-wholesale-order-form"))),E=()=>{x({title:e("deleteV2FormDataConfirm",wp.i18n.__("Are you sure you want to delete V2 Form Data?","woocommerce-wholesale-order-form")),icon:C(I),centered:!0,onOk(){r.deleteV2FormData().then(t=>{v.success({message:e("deleted",wp.i18n.__("Deleted","woocommerce-wholesale-order-form")),description:t.data.message,class:"wwof-success-notification",duration:2,onClose:()=>{y.location.reload()}})})},okText:e("yes",wp.i18n.__("Yes","woocommerce-wholesale-order-form")),cancelText:e("cancel",wp.i18n.__("Cancel","woocommerce-wholesale-order-form"))})},M=c(()=>({selectedRowKeys:o(f),onChange(t){f.value=t}})),R=[{title:e("orderFormName",wp.i18n.__("Order Form Name","woocommerce-wholesale-order-form")),dataIndex:"name",key:"name",class:"name"},{title:e("shortcode",wp.i18n.__("Shortcode","woocommerce-wholesale-order-form")),dataIndex:"shortcode",key:"shortcode"},{title:e("locations",wp.i18n.__("Locations","woocommerce-wholesale-order-form")),dataIndex:"locations",key:"locations",class:"locations"},{title:e("status",wp.i18n.__("Status","woocommerce-wholesale-order-form")),dataIndex:"status",key:"status"},{title:e("action",wp.i18n.__("Action","woocommerce-wholesale-order-form")),key:"action",dataIndex:"action"}],$=c(()=>Object.keys(r.formPosts).reverse().map(t=>{const a=r.formPosts[Number(t)];return{key:a.ID,name:a.post_title,shortcode:'[wwof_product_listing id="'.concat(a.ID,'"]'),locations:a.locations,status:a.post_status}})),j=c(()=>Object.keys(r.formPosts).map(t=>r.formPosts[t]).find(t=>t.v2==="is")),z=c(()=>Object.keys(r.formPosts).map(t=>r.formPosts[t]).find(t=>t.v2==="has")),k=D(1),G=t=>{k.value=t.current,r.formPostsQuery(k.value).then(a=>{r.formPosts=a.data})},K=c(()=>({current:k.value,total:V().orderForms.total}));return(t,a)=>{const _=W("RouterLink");return m(),q(U,null,[d("p",{class:"wwof-tw-text-base wwof-tw-mt-3 wwof-tw-mb-5",innerHTML:o(ro)(o(O))},null,8,no),d("div",lo,[z.value?(m(),i(J,{key:0,to:"#wwof-notices"},[d("div",co,[d("h4",null,l(o(e)("v2FormDataCleanupLabel",o(wp.i18n.__)("Confirm old form data cleanup","woocommerce-wholesale-order-form"))),1),d("p",null,l(o(e)("deleteV2FormDataDesc",o(wp.i18n.__)("Welcome to version 3.0 of Wholesale Order Form! Your forms have automatically been migrated to the new version. Once you have confirmed everything is working, click below to clean up the old form data.","woocommerce-wholesale-order-form"))),1),d("p",null,[w(o(g),{class:"remove-v2-forms-data-btn wwof-tw-border-slate-500 wwof-tw-italic",size:"small",onClick:E},{default:s(()=>[u(l(A.value),1)]),_:1})])])])):n("",!0),w(o(ao),null,{default:s(()=>[d("span",wo,l(o(e)("orderForms",o(wp.i18n.__)("Order Forms","woocommerce-wholesale-order-form"))),1),w(_,{to:"".concat(o(wp.url.addQueryArgs)(o(V)().adminBaseUrl,{post:"new"}))},{default:s(()=>[w(o(g),{size:"large",class:"wwof-tw-bg-gray-100 wwof-tw-text-sky-700 wwof-tw-border-sky-700 wwof-tw-font-bold"},{default:s(()=>[u(l(o(e)("addForm",o(wp.i18n.__)("Add Form","woocommerce-wholesale-order-form"))),1)]),_:1})]),_:1},8,["to"]),j.value?(m(),i(o(g),{key:0,class:"migrate-forms-btn wwof-tw-border-slate-500 wwof-tw-italic",size:"small",type:"dashed",onClick:L},{default:s(()=>[u(l(B.value),1)]),_:1})):n("",!0),o(f).length>0?(m(),i(o(g),{key:1,class:"delete-forms-btn",size:"large",danger:"",onClick:S},{default:s(()=>[u(l(o(e)("delete",o(wp.i18n.__)("Delete"))),1)]),_:1})):n("",!0)]),_:1})]),w(o(io),{class:"order-forms","row-selection":M.value,"data-source":$.value,columns:R,bordered:"",pagination:K.value,loading:o(r).formPostsQueryStatus===o(b).PENDING,onChange:G},{bodyCell:s(({column:h,record:p})=>[h.dataIndex==="name"?(m(),i(o(so),{key:0,justify:"space-between"},{default:s(()=>{var F;return[w(o(T),null,{default:s(()=>[u(l(p.name),1)]),_:2},1024),((F=o(r).formPosts[p.key])==null?void 0:F.v2)==="is"?(m(),i(o(T),{key:0},{default:s(()=>[w(o(mo),{class:"wwof-tw-text-yellow-500"},{default:s(()=>a[0]||(a[0]=[u(" v2 ")])),_:1})]),_:1})):n("",!0)]}),_:2},1024)):n("",!0),h.dataIndex==="shortcode"?(m(),i(X,{key:1,"form-id":p.key},null,8,["form-id"])):n("",!0),h.dataIndex==="locations"?(m(),i(Z,{key:2,locations:p.locations},null,8,["locations"])):n("",!0),h.dataIndex==="status"?(m(),i(oo,{key:3,status:p.status},null,8,["status"])):n("",!0),h.dataIndex==="action"?(m(),i(eo,{key:4,"form-id":p.key},null,8,["form-id"])):n("",!0)]),_:1},8,["row-selection","data-source","pagination","loading"])],64)}}});export{Ee as default};
