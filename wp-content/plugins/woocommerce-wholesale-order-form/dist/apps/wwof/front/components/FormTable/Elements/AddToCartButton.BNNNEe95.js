import{d as Q,G as tt,c,b as V,o as u,f as b,u as a,k as v,l as i,g as d,S as T,N as P,K as ot,L as et,J as D,aa as at,h as rt}from"../../../../../../common/LoadingOutlined.BFkAxzyV.js";import{u as it,_ as w,c as g,$ as N,j as dt,X as S,b as O,d as C,B as R,Y as q,Z as nt}from"../../../../../../common/index.Ith4SzXf.js";import{_ as lt}from"../../../../../../common/LoadingSpinner.vue_vue_type_script_setup_true_lang.BM77UlPO.js";import{S as j,a as ct}from"../../../../../../common/index.D3pgvkn5.js";import{B as ut}from"../../../../../../common/index.Bdw1ik1L.js";import{S as st}from"../../../../../../common/index.C08f97vy.js";import{_ as mt}from"../../../../../../common/_plugin-vue_export-helper.DlAUqK2U.js";import"../../../../../../common/_commonjsHelpers.BosuxZz1.js";import"../../../../../../common/ExclamationCircleFilled.CrW3q_TN.js";import"../../../../../../common/index.CjASPO7n.js";import"../../../../../../common/initDefaultProps.0LfrQis0.js";import"../../../../../../common/omit.DTkbSo29.js";import"../../../../../../common/index.DjkvlaSA.js";import"../../../../../../common/isVisible.BHYmLg1T.js";import"../../../../../../common/useState.L1hofs5h.js";import"../../../../../../common/raf.Deuc0E8-.js";import"../../../../../../common/devWarning.BVoSASTV.js";import"../../../../../../common/warning.CrM1WiW4.js";import"../../../../../../common/compact-item.Be3L5ggo.js";import"../../../../../../common/createContext.DiHI9yzd.js";import"../../../../../../common/Compact.bO-KmQeW.js";import"../../../../../../common/_getTag.CiIQqq4n.js";import"../../../../../../common/useFlexGapSupport.BqBlA3Mn.js";import"../../../../../../common/styleChecker.BhhSW-4N.js";const ft=["id"],pt=Q({__name:"AddToCartButton",props:{product:{},columnId:{}},setup(o){const z=C("components/FormTable/Elements/VariationDropdown.vue"),L=C("components/FormTable/Extras/AddToCartSuccess.vue"),_=C("components/FormTable/Extras/LoginToSeePrices.vue"),$=C("components/FormTable/Extras/SimplifyViewCart.vue"),f=it(),{addItemToCartRequest:G,quantities:J,standardSelected:h,isCardFormat:K}=tt(f),U=c(()=>{const t=w(o.columnId,"buttonText");return t||g("addToCart",wp.i18n.__("Add To Cart","woocommerce-wholesale-order-form"))}),W=c(()=>{var t;return(t=N(o.columnId,"buttonTextColor"))!=null?t:"#FFF"}),X=c(()=>{var t;return(t=N(o.columnId,"buttonColor"))!=null?t:"#40A9FF"}),Y=c(()=>w(o.columnId,"displayVariationDropdown")==="yes"),p=V(!1),k=c(()=>G.value===dt.PENDING),y=V(!1),Z=c(()=>{var t,n;return y.value&&((n=(t=f.formPost)==null?void 0:t.settings)==null?void 0:n.simplifyAddToCartNotices)!=="no"}),H=()=>{var s,m,A;const t=(s=w(o.columnId,"notificationDuration"))!=null?s:10;p.value=!0;const n=(A=(m=J.value)==null?void 0:m[o.product.id])!=null?A:1;y.value=!1;let r={id:o.product.id,quantity:n};if(o.product.type==="variable"){const e=S(o.product).value;e.attributes.some(l=>l.option==="")?r={...r,variation:Object.keys(h.value[o.product.id]).map(l=>({attribute:l,value:h.value[o.product.id][l]}))}:r={...r,id:e.id,parent_id:o.product.id}}f.addItemToCart(r).then(e=>{var l,I,E,x,B;p.value=!1;let F=[{...S(o.product).value,quantity:n}];w(o.columnId,"showAddToCartNotification")!=="no"&&((l=e==null?void 0:e.data)==null?void 0:l.items)!=null&&((I=e==null?void 0:e.data)==null?void 0:I.items.length)>0?((x=(E=f.formPost)==null?void 0:E.settings)==null?void 0:x.simplifyAddToCartNotices)==="no"?R.success({message:g("successfullyAdded",wp.i18n.__("Successfully added:","woocommerce-wholesale-order-form")),description:rt(L,{products:F,itemsOnCart:e.data.items}),duration:t,getContainer:q}):y.value=!0:(e==null?void 0:e.error)!=null&&R.error({message:g("errorCaps",wp.i18n.__("ERROR:","woocommerce-wholesale-order-form")),description:wp.htmlEntities.decodeEntities((B=e.error)==null?void 0:B.message),duration:t,getContainer:q}),document.body.dispatchEvent(new Event("wc_fragment_refresh")),nt("wwof_add_to_cart_request_response",e,o.product,n)})},M=c(()=>S(o.product).value.stock_status!=="outofstock");return(t,n)=>{var r,s,m;return u(),b("div",{id:"add-to-cart-button-".concat(t.product.id),class:"add-to-cart-btn-box",style:at({"--wwof-button-text-color":W.value,"--wwof-button-color":X.value})},[((r=a(O)())==null?void 0:r.appUser)==null&&((m=(s=a(O)())==null?void 0:s.wwpSettings)==null?void 0:m.hidePriceAddToCart)==="yes"?(u(),v(T,{key:0},{fallback:i(()=>[d(a(j),{active:"",paragraph:!1,title:!1})]),default:i(()=>[d(a(_))]),_:1})):(u(),b(P,{key:1},[d(a(st),{direction:a(K)?"vertical":"horizontal"},{default:i(()=>[d(a(ut),{size:"large",type:"primary",class:"add-to-cart-btn",disabled:!M.value||p.value&&k.value,onClick:H},{default:i(()=>[p.value&&k.value?(u(),v(lt,{key:0})):(u(),b(P,{key:1},[ot(et(U.value),1)],64))]),_:1},8,["disabled"]),Z.value?(u(),v(T,{key:0},{fallback:i(()=>[d(a(ct),{active:""})]),default:i(()=>[d(a($),{"column-id":t.columnId},null,8,["column-id"])]),_:1})):D("",!0)]),_:1},8,["direction"]),Y.value?(u(),v(T,{key:0},{fallback:i(()=>[d(a(j),{active:"",paragraph:!1,title:!1})]),default:i(()=>[d(a(z),{product:t.product,"column-id":t.columnId},null,8,["product","column-id"])]),_:1})):D("",!0)],64))],12,ft)}}}),zt=mt(pt,[["__scopeId","data-v-478391d1"]]);export{zt as default};
