!function(){function e(e,o){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);o&&(n=n.filter((function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable}))),t.push.apply(t,n)}return t}function o(o){for(var n=1;n<arguments.length;n++){var l=null!=arguments[n]?arguments[n]:{};n%2?e(Object(l),!0).forEach((function(e){t(o,e,l[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(l)):e(Object(l)).forEach((function(e){Object.defineProperty(o,e,Object.getOwnPropertyDescriptor(l,e))}))}return o}function t(e,o,t){return(o=function(e){var o=function(e,o){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,o||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===o?String:Number)(e)}(e,"string");return"symbol"==typeof o?o:o+""}(o))in e?Object.defineProperty(e,o,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[o]=t,e}System.register(["../../../../../common/LoadingOutlined-legacy.CPhLaklC.js","../../../../../common/index-legacy.BXaB4RSa.js","../../../../../common/LoadingSpinner.vue_vue_type_script_setup_true_lang-legacy.DUjpgbC2.js","../../../../../common/index-legacy.BwKQFx3_.js","../../../../../common/index-legacy.CiX7hMjz.js","../../../../../common/index-legacy.A55XFsN3.js","../../../../../common/_commonjsHelpers-legacy.DUdKTVN3.js","../../../../../common/ExclamationCircleFilled-legacy.pk-fzLqd.js","../../../../../common/index-legacy.6YzH0Q6d.js","../../../../../common/initDefaultProps-legacy.Dg02spAx.js","../../../../../common/index-legacy.BO0QmMSA.js","../../../../../common/isVisible-legacy.DY5sQV1e.js","../../../../../common/useState-legacy.Cz9hM3Y9.js","../../../../../common/raf-legacy.BuqC4Cal.js","../../../../../common/devWarning-legacy.BL7D_mCx.js","../../../../../common/warning-legacy.BV4CRm2j.js","../../../../../common/compact-item-legacy.DIFhuQPK.js","../../../../../common/createContext-legacy.BN14iAW9.js","../../../../../common/Compact-legacy.DDJsKFLh.js","../../../../../common/_getTag-legacy.C5XgQwbj.js","../../../../../common/omit-legacy.BQBjzFAf.js","../../../../../common/Col-legacy.BbwJYWOZ.js","../../../../../common/responsiveObserve-legacy.C9Flzrl6.js","../../../../../common/useFlexGapSupport-legacy.GR596bXG.js","../../../../../common/styleChecker-legacy.Cnshc1nm.js"],(function(e,t){"use strict";var n,l,r,i,a,s,c,d,u,m,v,p,f,y,g,j,b,_,w,h,C,O,I,P,T,x,S,E,N,k,A,D,q,F,L;return{setters:[e=>{n=e.d,l=e.G,r=e.c,i=e.b,a=e.o,s=e.f,c=e.g,d=e.l,u=e.u,m=e.aa,v=e.N,p=e.K,f=e.L,y=e.k,g=e.S,j=e.J,b=e.h},e=>{_=e.u,w=e.T,h=e.V,C=e.w,O=e.p,I=e.c,P=e.j,T=e.W,x=e.d,S=e.X,E=e.B,N=e.Y,k=e.Z},e=>{A=e._},e=>{D=e.B},e=>{q=e.a},e=>{F=e.C,L=e.R},null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){e("default",n({__name:"AddSelectedToCartButton",props:{sectionName:{},rowId:{},columnId:{},fieldId:{}},setup(e){const t=x("components/FormTable/Extras/AddToCartSuccess.vue"),n=x("components/FormTable/Extras/SimplifyViewCart.vue"),B=_(),{addItemToCartRequest:G,productsSelected:H,standardSelected:V,quantities:J,addToCartFormData:R}=l(B),W=w(e.sectionName,e.rowId,e.columnId,e.fieldId),K=r((()=>h(e.sectionName,e.rowId,e.columnId,e.fieldId))),M=r((()=>{var e;return C("wwof_add_selected_to_cart_button_text",O((null==W||null===(e=W.options)||void 0===e?void 0:e.buttonText)||I("addSelectedProductsToCart",wp.i18n.__("Add Selected Products To Cart","woocommerce-wholesale-order-form"))))})),X=i(!1),Y=r((()=>G.value===P.PENDING)),Z=i(null),$=async()=>{var e,n;Z.value=null;const l=null!==(e=null==W||null===(n=W.options)||void 0===n?void 0:n.notificationDuration)&&void 0!==e?e:10;X.value=!0;let r=[],i=H.value.map((e=>{var t,n;let l={id:e.id,quantity:null!==(t=null===(n=J.value)||void 0===n?void 0:n[e.id])&&void 0!==t?t:1};if("variable"===e.type){const t=S(e).value,n=t.attributes.some((e=>""===e.option));l=o(o({},l),{},n?{variation:Object.keys(V.value[e.id]).map((o=>({attribute:o,value:V.value[e.id][o]})))}:{id:t.id,parent_id:e.id})}return r.push(o(o({},S(e).value),{},{quantity:l.quantity})),l})),a=i.filter(((e,o,t)=>{var n,l,r;const i=null!==(n=null!==(l=null==e?void 0:e.parent_id)&&void 0!==l?l:null==e?void 0:e.id)&&void 0!==n?n:null;return void 0!==(null===(r=R.value)||void 0===r?void 0:r[i])}));a.length>0&&(i=i.filter((e=>!a.includes(e)))),await Promise.all([z(i),Q(a)]).then((e=>{X.value=!1;let o=[],n=[];var a,s,c,d;if(null!=e[0]&&(null!==(a=e[0])&&void 0!==a&&a.items&&(o=e[0].items),null!==(s=e[0])&&void 0!==s&&s.errors))for(const t of e[0].errors)n.push(`<p>${t.body.message}</p>`);if(void 0!==e[1])for(const[t,l]of Object.entries(e[1])){var u;if(201===l.response.status)for(const e of l.response.data.items)o.push(e);else null!=(null===(u=l.response)||void 0===u||null===(u=u.error)||void 0===u?void 0:u.message)&&(n.push(l.response.error.message),r=r.filter((e=>e.id!==parseInt(t))))}o&&o.length>0&&(o=o.filter(((e,o,t)=>o===t.findIndex((o=>o.key===e.key)))),"no"===(null===(c=B.formPost)||void 0===c||null===(c=c.settings)||void 0===c?void 0:c.simplifyAddToCartNotices)&&"no"!==(null==W||null===(d=W.options)||void 0===d?void 0:d.showAddToCartNotification)?E.success({message:I("successfullyAdded",wp.i18n.__("Successfully added:","woocommerce-wholesale-order-form")),description:b(t,{products:r,itemsOnCart:o}),duration:l,getContainer:N}):Z.value=o.reduce(((e,o)=>e+o.quantity),0),H.value=[],document.body.dispatchEvent(new Event("wc_fragment_refresh")));n&&n.length>0&&E.error({message:I("errorAddingToCart",wp.i18n.__("Error adding to cart:","woocommerce-wholesale-order-form")),description:b("div",{innerHTML:wp.htmlEntities.decodeEntities(n.join(""))}),duration:l,getContainer:N}),k("wwof_add_selected_to_cart_request_response",e,i)}))},z=async e=>{if(e.length>0)try{return await B.addItemsToCart(e)}catch(o){return o}},Q=async e=>{if(e.length>0){let n=[];for(const l of e)try{const e=await B.addItemToCart(l);n=o(o({},n),{},{[l.id]:{response:e}})}catch(t){n=o(o({},n),{},{[l.id]:{error:t}})}return n}},U=r((()=>{var e;return Z.value&&"no"!==(null===(e=B.formPost)||void 0===e||null===(e=e.settings)||void 0===e?void 0:e.simplifyAddToCartNotices)}));return(e,o)=>(a(),s("div",{class:"add-selected-to-cart-button-box",style:m(u(T)(e.sectionName,e.rowId,e.columnId,e.fieldId))},[c(u(L),null,{default:d((()=>[c(u(F),{xs:"24",sm:"8"},{default:d((()=>[c(u(D),{type:"primary",style:m(K.value),disabled:0===u(H).length||X.value||Y.value,onClick:$},{default:d((()=>[X.value||Y.value?(a(),s(v,{key:0},[p(f(u(I)("addingProducts",u(wp.i18n.__)("Adding products to cart...","woocommerce-wholesale-order-form")))+"Â  ",1),c(A)],64)):(a(),s(v,{key:1},[p(f(M.value),1)],64))])),_:1},8,["style","disabled"])])),_:1}),c(u(F),{xs:"24",sm:"16"},{default:d((()=>[U.value?(a(),y(g,{key:0},{fallback:d((()=>[c(u(q),{active:""})])),default:d((()=>[c(u(n),{"products-added":Z.value},null,8,["products-added"])])),_:1})):j("",!0)])),_:1})])),_:1})],4))}}))}}}))}();
