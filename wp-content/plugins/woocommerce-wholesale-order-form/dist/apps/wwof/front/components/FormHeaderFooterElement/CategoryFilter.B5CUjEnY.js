import{i as wt,p as bt,d as xe,b as ye,c as y,w as Ie,n as St,s as M,ax as ae,g as U,E as G,z as w,ar as It,ao as xt,a0 as Qe,a9 as re,bk as kt,P as fe,x as Vt,y as ht,A as Tt,bf as Nt,D as et,Y as Et,U as $e,R as Lt,Q as Dt,a4 as Pt,T as Me,G as Kt,B as Ot,o as de,f as tt,u as H,k as be,l as Re,K as lt,L as at,N as _t,a8 as Ft,aa as je}from"../../../../../common/LoadingOutlined.BFkAxzyV.js";import{T as At,V as Ht,u as Bt,j as nt,c as ot,g as Y,b as We,w as $t,Y as rt,W as Mt,k as Se}from"../../../../../common/index.Ith4SzXf.js";import{u as Rt,a as jt,b as Wt,c as Ut,d as zt,t as st,B as Yt,e as Gt,f as Xt,g as qt,S as Ue}from"../../../../../common/index.BGHkQlAe.js";import{K as ve}from"../../../../../common/KeyCode.B_gOgbN6.js";import{T as Qt,c as Jt,a as Ge,u as Zt,i as el,r as tl}from"../../../../../common/index.FTpNJ4uu.js";import{o as ke}from"../../../../../common/omit.DTkbSo29.js";import{i as mt}from"../../../../../common/initDefaultProps.0LfrQis0.js";import{u as it}from"../../../../../common/useMergedState.DXdtLiCT.js";import{d as ze}from"../../../../../common/devWarning.BVoSASTV.js";import{w as ll}from"../../../../../common/warning.CrM1WiW4.js";import{a as al,F as nl}from"../../../../../common/FormItemContext.CuFDkfIX.js";import{e as ol}from"../../../../../common/ExclamationCircleFilled.CrW3q_TN.js";import{g as rl,a as sl}from"../../../../../common/statusUtils.DES_qYlM.js";import{g as il}from"../../../../../common/index.BYshCuJZ.js";import{a as ul}from"../../../../../common/Compact.bO-KmQeW.js";import{_ as cl}from"../../../../../common/_plugin-vue_export-helper.DlAUqK2U.js";import"../../../../../common/_commonjsHelpers.BosuxZz1.js";import"../../../../../common/motion.WGHlFb5s.js";import"../../../../../common/raf.Deuc0E8-.js";import"../../../../../common/vnode.BC_D2aP8.js";import"../../../../../common/isVisible.BHYmLg1T.js";import"../../../../../common/ResizeObserver.es.B1PUzC5B.js";import"../../../../../common/_getTag.CiIQqq4n.js";import"../../../../../common/PortalWrapper.BCGj8rtm.js";import"../../../../../common/BaseInput.C6Ke7hb1.js";import"../../../../../common/pickAttrs.GzdKbNmm.js";import"../../../../../common/slide.DZmo5x4X.js";import"../../../../../common/isMobile.BbN7I0i_.js";import"../../../../../common/useState.L1hofs5h.js";import"../../../../../common/DownOutlined.Bgw7W-Qg.js";import"../../../../../common/SearchOutlined.K2PZqdQC.js";import"../../../../../common/move.iWCDh3n7.js";import"../../../../../common/compact-item.Be3L5ggo.js";import"../../../../../common/eagerComputed.Bhszqfqe.js";import"../../../../../common/collapseMotion.CnwYBKtm.js";import"../../../../../common/createContext.DiHI9yzd.js";function dl(e){return Array.isArray(e)?e:e!==void 0?[e]:[]}function vl(e){const{label:c,value:r,children:a}=e||{},t=r||"value";return{_title:c?[c]:["title","label"],value:t,key:t,children:a||"children"}}function Xe(e){return e.disabled||e.disableCheckbox||e.checkable===!1}function fl(e,c){const r=[];function a(t){t.forEach(s=>{r.push(s[c.value]);const o=s[c.children];o&&a(o)})}return a(e),r}function ut(e){return e==null}const pt=Symbol("TreeSelectContextPropsKey");function hl(e){return bt(pt,e)}function ml(){return wt(pt,{})}const pl={width:0,height:0,display:"flex",overflow:"hidden",opacity:0,border:0,padding:0,margin:0},gl=xe({compatConfig:{MODE:3},name:"OptionList",inheritAttrs:!1,setup(e,c){let{slots:r,expose:a}=c;const t=Rt(),s=jt(),o=ml(),i=ye(),f=Wt(()=>o.treeData,[()=>t.open,()=>o.treeData],l=>l[0]),n=y(()=>{const{checkable:l,halfCheckedKeys:m,checkedKeys:N}=s;return l?{checked:N,halfChecked:m}:null});Ie(()=>t.open,()=>{St(()=>{var l;t.open&&!t.multiple&&s.checkedKeys.length&&((l=i.value)===null||l===void 0||l.scrollTo({key:s.checkedKeys[0]}))})},{immediate:!0,flush:"post"});const u=y(()=>String(t.searchValue).toLowerCase()),g=l=>u.value?String(l[s.treeNodeFilterProp]).toLowerCase().includes(u.value):!1,S=M(s.treeDefaultExpandedKeys),x=M(null);Ie(()=>t.searchValue,()=>{t.searchValue&&(x.value=fl(ae(o.treeData),ae(o.fieldNames)))},{immediate:!0});const k=y(()=>s.treeExpandedKeys?s.treeExpandedKeys.slice():t.searchValue?x.value:S.value),I=l=>{var m;S.value=l,x.value=l,(m=s.onTreeExpand)===null||m===void 0||m.call(s,l)},T=l=>{l.preventDefault()},A=(l,m)=>{let{node:N}=m;var F,D;const{checkable:z,checkedKeys:X}=s;z&&Xe(N)||((F=o.onSelect)===null||F===void 0||F.call(o,N.key,{selected:!X.includes(N.key)}),t.multiple||(D=t.toggleOpen)===null||D===void 0||D.call(t,!1))},K=ye(null),v=y(()=>s.keyEntities[K.value]),h=l=>{K.value=l};return a({scrollTo:function(){for(var l,m,N=arguments.length,F=new Array(N),D=0;D<N;D++)F[D]=arguments[D];return(m=(l=i.value)===null||l===void 0?void 0:l.scrollTo)===null||m===void 0?void 0:m.call(l,...F)},onKeydown:l=>{var m;const{which:N}=l;switch(N){case ve.UP:case ve.DOWN:case ve.LEFT:case ve.RIGHT:(m=i.value)===null||m===void 0||m.onKeydown(l);break;case ve.ENTER:{if(v.value){const{selectable:F,value:D}=v.value.node||{};F!==!1&&A(null,{node:{key:K.value},selected:!s.checkedKeys.includes(D)})}break}case ve.ESC:t.toggleOpen(!1)}},onKeyup:()=>{}}),()=>{var l;const{prefixCls:m,multiple:N,searchValue:F,open:D,notFoundContent:z=(l=r.notFoundContent)===null||l===void 0?void 0:l.call(r)}=t,{listHeight:X,listItemHeight:R,virtual:ne,dropdownMatchSelectWidth:q,treeExpandAction:se}=o,{checkable:ie,treeDefaultExpandAll:ue,treeIcon:oe,showTreeIcon:Q,switcherIcon:me,treeLine:pe,loadData:ge,treeLoadedKeys:ce,treeMotion:b,onTreeLoad:O,checkedKeys:B}=s;if(f.value.length===0)return U("div",{role:"listbox",class:"".concat(m,"-empty"),onMousedown:T},[z]);const J={fieldNames:o.fieldNames};return ce&&(J.loadedKeys=ce),k.value&&(J.expandedKeys=k.value),U("div",{onMousedown:T},[v.value&&D&&U("span",{style:pl,"aria-live":"assertive"},[v.value.node.value]),U(Qt,G(G({ref:i,focusable:!1,prefixCls:"".concat(m,"-tree"),treeData:f.value,height:X,itemHeight:R,virtual:ne!==!1&&q!==!1,multiple:N,icon:oe,showIcon:Q,switcherIcon:me,showLine:pe,loadData:F?null:ge,motion:b,activeKey:K.value,checkable:ie,checkStrictly:!0,checkedKeys:n.value,selectedKeys:ie?[]:B,defaultExpandAll:ue},J),{},{onActiveChange:h,onSelect:A,onCheck:A,onExpand:I,onLoad:O,filterTreeNode:g,expandAction:se}),w(w({},r),{checkable:s.customSlots.treeCheckable}))])}}}),yl="SHOW_ALL",gt="SHOW_PARENT",Je="SHOW_CHILD";function ct(e,c,r,a){const t=new Set(e);return c===Je?e.filter(s=>{const o=r[s];return!(o&&o.children&&o.children.some(i=>{let{node:f}=i;return t.has(f[a.value])})&&o.children.every(i=>{let{node:f}=i;return Xe(f)||t.has(f[a.value])}))}):c===gt?e.filter(s=>{const o=r[s],i=o?o.parent:null;return!(i&&!Xe(i.node)&&t.has(i.key))}):e}const he=()=>null;he.inheritAttrs=!1;he.displayName="ATreeSelectNode";he.isTreeSelectNode=!0;var Cl=function(e,c){var r={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&c.indexOf(a)<0&&(r[a]=e[a]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var t=0,a=Object.getOwnPropertySymbols(e);t<a.length;t++)c.indexOf(a[t])<0&&Object.prototype.propertyIsEnumerable.call(e,a[t])&&(r[a[t]]=e[a[t]]);return r};function wl(e){return e&&e.type&&e.type.isTreeSelectNode}function bl(e){function c(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return It(r).map(a=>{var t,s,o;if(!wl(a))return null;const i=a.children||{},f=a.key,n={};for(const[N,F]of Object.entries(a.props))n[xt(N)]=F;const{isLeaf:u,checkable:g,selectable:S,disabled:x,disableCheckbox:k}=n,I={isLeaf:u||u===""||void 0,checkable:g||g===""||void 0,selectable:S||S===""||void 0,disabled:x||x===""||void 0,disableCheckbox:k||k===""||void 0},T=w(w({},n),I),{title:A=(t=i.title)===null||t===void 0?void 0:t.call(i,T),switcherIcon:K=(s=i.switcherIcon)===null||s===void 0?void 0:s.call(i,T)}=n,v=Cl(n,["title","switcherIcon"]),h=(o=i.default)===null||o===void 0?void 0:o.call(i),l=w(w(w({},v),{title:A,switcherIcon:K,key:f,isLeaf:u}),I),m=c(h);return m.length&&(l.children=m),l})}return c(e)}function qe(e){if(!e)return e;const c=w({},e);return"props"in c||Object.defineProperty(c,"props",{get(){return c}}),c}function Sl(e,c,r,a,t,s){let o=null,i=null;function f(){function n(u){let g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"0",S=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return u.map((x,k)=>{const I="".concat(g,"-").concat(k),T=x[s.value],A=r.includes(T),K=n(x[s.children]||[],I,A),v=U(he,x,{default:()=>[K.map(h=>h.node)]});if(c===T&&(o=v),A){const h={pos:I,node:v,children:K};return S||i.push(h),h}return null}).filter(x=>x)}i||(i=[],n(a),i.sort((u,g)=>{let{node:{props:{value:S}}}=u,{node:{props:{value:x}}}=g;const k=r.indexOf(S),I=r.indexOf(x);return k-I}))}Object.defineProperty(e,"triggerNode",{get(){return f(),o}}),Object.defineProperty(e,"allCheckedNodes",{get(){return f(),t?i:i.map(n=>{let{node:u}=n;return u})}})}function Il(e,c){let{id:r,pId:a,rootPId:t}=c;const s={},o=[];return e.map(f=>{const n=w({},f),u=n[r];return s[u]=n,n.key=n.key||u,n}).forEach(f=>{const n=f[a],u=s[n];u&&(u.children=u.children||[],u.children.push(f)),(n===t||!u&&t===null)&&o.push(f)}),o}function xl(e,c,r){const a=M();return Ie([r,e,c],()=>{const t=r.value;e.value?a.value=r.value?Il(ae(e.value),w({id:"id",pId:"pId",rootPId:null},t!==!0?t:{})):ae(e.value).slice():a.value=bl(ae(c.value))},{immediate:!0,deep:!0}),a}const kl=e=>{const c=M({valueLabels:new Map}),r=M();return Ie(e,()=>{r.value=ae(e.value)},{immediate:!0}),[y(()=>{const{valueLabels:t}=c.value,s=new Map,o=r.value.map(i=>{var f;const{value:n}=i,u=(f=i.label)!==null&&f!==void 0?f:t.get(n);return s.set(n,u),w(w({},i),{label:u})});return c.value.valueLabels=s,o})]},Vl=(e,c)=>{const r=M(new Map),a=M({});return Qe(()=>{const t=c.value,s=Jt(e.value,{fieldNames:t,initWrapper:o=>w(w({},o),{valueEntities:new Map}),processEntity:(o,i)=>{const f=o.node[t.value];i.valueEntities.set(f,o)}});r.value=s.valueEntities,a.value=s.keyEntities}),{valueEntities:r,keyEntities:a}},Tl=(e,c,r,a,t,s)=>{const o=M([]),i=M([]);return Qe(()=>{let f=e.value.map(g=>{let{value:S}=g;return S}),n=c.value.map(g=>{let{value:S}=g;return S});const u=f.filter(g=>!a.value[g]);r.value&&({checkedKeys:f,halfCheckedKeys:n}=Ge(f,!0,a.value,t.value,s.value)),o.value=Array.from(new Set([...u,...f])),i.value=n}),[o,i]},Nl=(e,c,r)=>{let{treeNodeFilterProp:a,filterTreeNode:t,fieldNames:s}=r;return y(()=>{const{children:o}=s.value,i=c.value,f=a==null?void 0:a.value;if(!i||t.value===!1)return e.value;let n;if(typeof t.value=="function")n=t.value;else{const g=i.toUpperCase();n=(S,x)=>{const k=x[f];return String(k).toUpperCase().includes(g)}}function u(g){let S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const x=[];for(let k=0,I=g.length;k<I;k++){const T=g[k],A=T[o],K=S||n(i,qe(T)),v=u(A||[],K);(K||v.length)&&x.push(w(w({},T),{[o]:v}))}return x}return u(e.value)})};function yt(){return w(w({},ke(Gt(),["mode"])),{prefixCls:String,id:String,value:{type:[String,Number,Object,Array]},defaultValue:{type:[String,Number,Object,Array]},onChange:{type:Function},searchValue:String,inputValue:String,onSearch:{type:Function},autoClearSearchValue:{type:Boolean,default:void 0},filterTreeNode:{type:[Boolean,Function],default:void 0},treeNodeFilterProp:String,onSelect:Function,onDeselect:Function,showCheckedStrategy:{type:String},treeNodeLabelProp:String,fieldNames:{type:Object},multiple:{type:Boolean,default:void 0},treeCheckable:{type:Boolean,default:void 0},treeCheckStrictly:{type:Boolean,default:void 0},labelInValue:{type:Boolean,default:void 0},treeData:{type:Array},treeDataSimpleMode:{type:[Boolean,Object],default:void 0},loadData:{type:Function},treeLoadedKeys:{type:Array},onTreeLoad:{type:Function},treeDefaultExpandAll:{type:Boolean,default:void 0},treeExpandedKeys:{type:Array},treeDefaultExpandedKeys:{type:Array},onTreeExpand:{type:Function},virtual:{type:Boolean,default:void 0},listHeight:Number,listItemHeight:Number,onDropdownVisibleChange:{type:Function},treeLine:{type:[Boolean,Object],default:void 0},treeIcon:fe.any,showTreeIcon:{type:Boolean,default:void 0},switcherIcon:fe.any,treeMotion:fe.any,children:Array,treeExpandAction:String,showArrow:{type:Boolean,default:void 0},showSearch:{type:Boolean,default:void 0},open:{type:Boolean,default:void 0},defaultOpen:{type:Boolean,default:void 0},disabled:{type:Boolean,default:void 0},placeholder:fe.any,maxTagPlaceholder:{type:Function},dropdownPopupAlign:fe.any,customSlots:Object})}function El(e){return!e||typeof e!="object"}const Ll=xe({compatConfig:{MODE:3},name:"TreeSelect",inheritAttrs:!1,props:mt(yt(),{treeNodeFilterProp:"value",autoClearSearchValue:!0,showCheckedStrategy:Je,listHeight:200,listItemHeight:20,prefixCls:"vc-tree-select"}),setup(e,c){let{attrs:r,expose:a,slots:t}=c;const s=Ut(re(e,"id")),o=y(()=>e.treeCheckable&&!e.treeCheckStrictly),i=y(()=>e.treeCheckable||e.treeCheckStrictly),f=y(()=>e.treeCheckStrictly||e.labelInValue),n=y(()=>i.value||e.multiple),u=y(()=>vl(e.fieldNames)),[g,S]=it("",{value:y(()=>e.searchValue!==void 0?e.searchValue:e.inputValue),postState:d=>d||""}),x=d=>{var p;S(d),(p=e.onSearch)===null||p===void 0||p.call(e,d)},k=xl(re(e,"treeData"),re(e,"children"),re(e,"treeDataSimpleMode")),{keyEntities:I,valueEntities:T}=Vl(k,u),A=d=>{const p=[],C=[];return d.forEach(E=>{T.value.has(E)?C.push(E):p.push(E)}),{missingRawValues:p,existRawValues:C}},K=Nl(k,g,{fieldNames:u,treeNodeFilterProp:re(e,"treeNodeFilterProp"),filterTreeNode:re(e,"filterTreeNode")}),v=d=>{if(d){if(e.treeNodeLabelProp)return d[e.treeNodeLabelProp];const{_title:p}=u.value;for(let C=0;C<p.length;C+=1){const E=d[p[C]];if(E!==void 0)return E}}},h=d=>dl(d).map(C=>El(C)?{value:C}:C),l=d=>h(d).map(C=>{let{label:E}=C;const{value:_,halfChecked:P}=C;let V;const L=T.value.get(_);return L&&(E=E!=null?E:v(L.node),V=L.node.disabled),{label:E,value:_,halfChecked:P,disabled:V}}),[m,N]=it(e.defaultValue,{value:re(e,"value")}),F=y(()=>h(m.value)),D=M([]),z=M([]);Qe(()=>{const d=[],p=[];F.value.forEach(C=>{C.halfChecked?p.push(C):d.push(C)}),D.value=d,z.value=p});const X=y(()=>D.value.map(d=>d.value)),{maxLevel:R,levelEntities:ne}=Zt(I),[q,se]=Tl(D,z,o,I,R,ne),ie=y(()=>{const C=ct(q.value,e.showCheckedStrategy,I.value,u.value).map(P=>{var V,L,$;return($=(L=(V=I.value[P])===null||V===void 0?void 0:V.node)===null||L===void 0?void 0:L[u.value.value])!==null&&$!==void 0?$:P}).map(P=>{const V=D.value.find(L=>L.value===P);return{value:P,label:V==null?void 0:V.label}}),E=l(C),_=E[0];return!n.value&&_&&ut(_.value)&&ut(_.label)?[]:E.map(P=>{var V;return w(w({},P),{label:(V=P.label)!==null&&V!==void 0?V:P.value})})}),[ue]=kl(ie),oe=(d,p,C)=>{const E=l(d);if(N(E),e.autoClearSearchValue&&S(""),e.onChange){let _=d;o.value&&(_=ct(d,e.showCheckedStrategy,I.value,u.value).map(le=>{const we=T.value.get(le);return we?we.node[u.value.value]:le}));const{triggerValue:P,selected:V}=p||{triggerValue:void 0,selected:void 0};let L=_;if(e.treeCheckStrictly){const W=z.value.filter(le=>!_.includes(le.value));L=[...L,...W]}const $=l(L),ee={preValue:D.value,triggerValue:P};let te=!0;(e.treeCheckStrictly||C==="selection"&&!V)&&(te=!1),Sl(ee,P,d,k.value,te,u.value),i.value?ee.checked=V:ee.selected=V;const j=f.value?$:$.map(W=>W.value);e.onChange(n.value?j:j[0],f.value?null:$.map(W=>W.label),ee)}},Q=(d,p)=>{let{selected:C,source:E}=p;var _,P,V;const L=ae(I.value),$=ae(T.value),ee=L[d],te=ee==null?void 0:ee.node,j=(_=te==null?void 0:te[u.value.value])!==null&&_!==void 0?_:d;if(!n.value)oe([j],{selected:!0,triggerValue:j},"option");else{let W=C?[...X.value,j]:q.value.filter(le=>le!==j);if(o.value){const{missingRawValues:le,existRawValues:we}=A(W),Ze=we.map(Be=>$.get(Be).key);let He;C?{checkedKeys:He}=Ge(Ze,!0,L,R.value,ne.value):{checkedKeys:He}=Ge(Ze,{checked:!1,halfCheckedKeys:se.value},L,R.value,ne.value),W=[...le,...He.map(Be=>L[Be].node[u.value.value])]}oe(W,{selected:C,triggerValue:j},E||"option")}C||!n.value?(P=e.onSelect)===null||P===void 0||P.call(e,j,qe(te)):(V=e.onDeselect)===null||V===void 0||V.call(e,j,qe(te))},me=d=>{if(e.onDropdownVisibleChange){const p={};Object.defineProperty(p,"documentClickClose",{get(){return!1}}),e.onDropdownVisibleChange(d,p)}},pe=(d,p)=>{const C=d.map(E=>E.value);if(p.type==="clear"){oe(C,{},"selection");return}p.values.length&&Q(p.values[0].value,{selected:!1,source:"selection"})},{treeNodeFilterProp:ge,loadData:ce,treeLoadedKeys:b,onTreeLoad:O,treeDefaultExpandAll:B,treeExpandedKeys:J,treeDefaultExpandedKeys:Ve,onTreeExpand:Te,virtual:Ne,listHeight:Ee,listItemHeight:Le,treeLine:De,treeIcon:Ce,showTreeIcon:Pe,switcherIcon:Ke,treeMotion:Oe,customSlots:_e,dropdownMatchSelectWidth:Fe,treeExpandAction:Ae}=kt(e);zt(st({checkable:i,loadData:ce,treeLoadedKeys:b,onTreeLoad:O,checkedKeys:q,halfCheckedKeys:se,treeDefaultExpandAll:B,treeExpandedKeys:J,treeDefaultExpandedKeys:Ve,onTreeExpand:Te,treeIcon:Ce,treeMotion:Oe,showTreeIcon:Pe,switcherIcon:Ke,treeLine:De,treeNodeFilterProp:ge,keyEntities:I,customSlots:_e})),hl(st({virtual:Ne,listHeight:Ee,listItemHeight:Le,treeData:K,fieldNames:u,onSelect:Q,dropdownMatchSelectWidth:Fe,treeExpandAction:Ae}));const Z=ye();return a({focus(){var d;(d=Z.value)===null||d===void 0||d.focus()},blur(){var d;(d=Z.value)===null||d===void 0||d.blur()},scrollTo(d){var p;(p=Z.value)===null||p===void 0||p.scrollTo(d)}}),()=>{var d;const p=ke(e,["id","prefixCls","customSlots","value","defaultValue","onChange","onSelect","onDeselect","searchValue","inputValue","onSearch","autoClearSearchValue","filterTreeNode","treeNodeFilterProp","showCheckedStrategy","treeNodeLabelProp","multiple","treeCheckable","treeCheckStrictly","labelInValue","fieldNames","treeDataSimpleMode","treeData","children","loadData","treeLoadedKeys","onTreeLoad","treeDefaultExpandAll","treeExpandedKeys","treeDefaultExpandedKeys","onTreeExpand","virtual","listHeight","listItemHeight","onDropdownVisibleChange","treeLine","treeIcon","showTreeIcon","switcherIcon","treeMotion"]);return U(Yt,G(G(G({ref:Z},r),p),{},{id:s,prefixCls:e.prefixCls,mode:n.value?"multiple":void 0,displayValues:ue.value,onDisplayValuesChange:pe,searchValue:g.value,onSearch:x,OptionList:gl,emptyOptions:!k.value.length,onDropdownVisibleChange:me,tagRender:e.tagRender||t.tagRender,dropdownMatchSelectWidth:(d=e.dropdownMatchSelectWidth)!==null&&d!==void 0?d:!0}),t)}}}),Dl=e=>{const{componentCls:c,treePrefixCls:r,colorBgElevated:a}=e,t=".".concat(r);return[{["".concat(c,"-dropdown")]:[{padding:"".concat(e.paddingXS,"px ").concat(e.paddingXS/2,"px")},el(r,ht(e,{colorBgContainer:a})),{[t]:{borderRadius:0,"&-list-holder-inner":{alignItems:"stretch",["".concat(t,"-treenode")]:{["".concat(t,"-node-content-wrapper")]:{flex:"auto"}}}}},il("".concat(r,"-checkbox"),e),{"&-rtl":{direction:"rtl",["".concat(t,"-switcher").concat(t,"-switcher_close")]:{["".concat(t,"-switcher-icon svg")]:{transform:"rotate(90deg)"}}}}]}]};function Pl(e,c){return Vt("TreeSelect",r=>{const a=ht(r,{treePrefixCls:c.value});return[Dl(a)]})(e)}const dt=(e,c,r)=>r!==void 0?r:"".concat(e,"-").concat(c);function Kl(){return w(w({},ke(yt(),["showTreeIcon","treeMotion","inputIcon","getInputElement","treeLine","customSlots"])),{suffixIcon:fe.any,size:$e(),bordered:Lt(),treeLine:Dt([Boolean,Object]),replaceFields:Pt(),placement:$e(),status:$e(),popupClassName:String,dropdownClassName:String,"onUpdate:value":Me(),"onUpdate:treeExpandedKeys":Me(),"onUpdate:searchValue":Me()})}const Ye=xe({compatConfig:{MODE:3},name:"ATreeSelect",inheritAttrs:!1,props:mt(Kl(),{choiceTransitionName:"",listHeight:256,treeIcon:!1,listItemHeight:26,bordered:!0}),slots:Object,setup(e,c){let{attrs:r,slots:a,expose:t,emit:s}=c;ll(!(e.treeData===void 0&&a.default)),ze(e.multiple!==!1||!e.treeCheckable,"TreeSelect","`multiple` will always be `true` when `treeCheckable` is true"),ze(e.replaceFields===void 0,"TreeSelect","`replaceFields` is deprecated, please use fieldNames instead"),ze(!e.dropdownClassName,"TreeSelect","`dropdownClassName` is deprecated. Please use `popupClassName` instead.");const o=al(),i=nl.useInject(),f=y(()=>rl(i.status,e.status)),{prefixCls:n,renderEmpty:u,direction:g,virtual:S,dropdownMatchSelectWidth:x,size:k,getPopupContainer:I,getPrefixCls:T,disabled:A}=Tt("select",e),{compactSize:K,compactItemClassnames:v}=ul(n,g),h=y(()=>K.value||k.value),l=Nt(),m=y(()=>{var b;return(b=A.value)!==null&&b!==void 0?b:l.value}),N=y(()=>T()),F=y(()=>e.placement!==void 0?e.placement:g.value==="rtl"?"bottomRight":"bottomLeft"),D=y(()=>dt(N.value,ol(F.value),e.transitionName)),z=y(()=>dt(N.value,"",e.choiceTransitionName)),X=y(()=>T("select-tree",e.prefixCls)),R=y(()=>T("tree-select",e.prefixCls)),[ne,q]=Xt(n),[se]=Pl(R,X),ie=y(()=>et(e.popupClassName||e.dropdownClassName,"".concat(R.value,"-dropdown"),{["".concat(R.value,"-dropdown-rtl")]:g.value==="rtl"},q.value)),ue=y(()=>!!(e.treeCheckable||e.multiple)),oe=y(()=>e.showArrow!==void 0?e.showArrow:e.loading||!ue.value),Q=ye();t({focus(){var b,O;(O=(b=Q.value).focus)===null||O===void 0||O.call(b)},blur(){var b,O;(O=(b=Q.value).blur)===null||O===void 0||O.call(b)}});const me=function(){for(var b=arguments.length,O=new Array(b),B=0;B<b;B++)O[B]=arguments[B];s("update:value",O[0]),s("change",...O),o.onFieldChange()},pe=b=>{s("update:treeExpandedKeys",b),s("treeExpand",b)},ge=b=>{s("update:searchValue",b),s("search",b)},ce=b=>{s("blur",b),o.onFieldBlur()};return()=>{var b,O,B;const{notFoundContent:J=(b=a.notFoundContent)===null||b===void 0?void 0:b.call(a),prefixCls:Ve,bordered:Te,listHeight:Ne,listItemHeight:Ee,multiple:Le,treeIcon:De,treeLine:Ce,showArrow:Pe,switcherIcon:Ke=(O=a.switcherIcon)===null||O===void 0?void 0:O.call(a),fieldNames:Oe=e.replaceFields,id:_e=o.id.value,placeholder:Fe=(B=a.placeholder)===null||B===void 0?void 0:B.call(a)}=e,{isFormItemInput:Ae,hasFeedback:Z,feedbackIcon:d}=i,{suffixIcon:p,removeIcon:C,clearIcon:E}=qt(w(w({},e),{multiple:ue.value,showArrow:oe.value,hasFeedback:Z,feedbackIcon:d,prefixCls:n.value}),a);let _;J!==void 0?_=J:_=u("Select");const P=ke(e,["suffixIcon","itemIcon","removeIcon","clearIcon","switcherIcon","bordered","status","onUpdate:value","onUpdate:treeExpandedKeys","onUpdate:searchValue"]),V=et(!Ve&&R.value,{["".concat(n.value,"-lg")]:h.value==="large",["".concat(n.value,"-sm")]:h.value==="small",["".concat(n.value,"-rtl")]:g.value==="rtl",["".concat(n.value,"-borderless")]:!Te,["".concat(n.value,"-in-form-item")]:Ae},sl(n.value,f.value,Z),v.value,r.class,q.value),L={};return e.treeData===void 0&&a.default&&(L.children=Et(a.default())),ne(se(U(Ll,G(G(G(G({},r),P),{},{disabled:m.value,virtual:S.value,dropdownMatchSelectWidth:x.value,id:_e,fieldNames:Oe,ref:Q,prefixCls:n.value,class:V,listHeight:Ne,listItemHeight:Ee,treeLine:!!Ce,inputIcon:p,multiple:Le,removeIcon:C,clearIcon:E,switcherIcon:$=>tl(X.value,Ke,$,a.leafIcon,Ce),showTreeIcon:De,notFoundContent:_,getPopupContainer:I==null?void 0:I.value,treeMotion:null,dropdownClassName:ie.value,choiceTransitionName:z.value,onChange:me,onBlur:ce,onSearch:ge,onTreeExpand:pe},L),{},{transitionName:D.value,customSlots:w(w({},a),{treeCheckable:()=>U("span",{class:"".concat(n.value,"-tree-checkbox-inner")},null)}),maxTagPlaceholder:e.maxTagPlaceholder||a.maxTagPlaceholder,placement:F.value,showArrow:Z||Pe,placeholder:Fe}),w(w({},a),{treeCheckable:()=>U("span",{class:"".concat(n.value,"-tree-checkbox-inner")},null)}))))}}}),vt=he,ft=w(Ye,{TreeNode:he,SHOW_ALL:yl,SHOW_PARENT:gt,SHOW_CHILD:Je,install:e=>(e.component(Ye.name,Ye),e.component(vt.displayName,vt),e)}),Ct=(e,c=0)=>{let r=[];return window.lodash.sortBy(e.filter(t=>c===t.parent),"menu_order").forEach(t=>{var i,f,n;const s=Ct(e.filter(u=>u.parent!==0),t.id);let o=(i=e.filter(u=>u.id===t.parent)[0])!=null?i:null;for(;o&&o.parent!==0;)o=(f=e.filter(u=>u.id===o.parent)[0])!=null?f:null;r.push({key:t.id,label:(n=wp.htmlEntities.decodeEntities(t.label))!=null?n:"".concat(t.id),value:t.id,menu_order:t.menu_order,children:s})}),r},Ol=xe({__name:"CategoryFilter",props:{sectionName:{},rowId:{},columnId:{},fieldId:{}},setup(e){const c=y(()=>At(e.sectionName,e.rowId,e.columnId,e.fieldId)),{on:r}=Se("wwofDefaultCategorySettingsChange"),{on:a}=Se("wwofIncludedCategoryChange"),{on:t}=Se("wwofExcludedCategoryChange"),s=y(()=>Ht(e.sectionName,e.rowId,e.columnId,e.fieldId)),{emit:o}=Se("wwofCategorySelectSubmit"),i=Bt(),{wcCategoriesRequestView:f,categories:n,categorySelected:u}=Kt(i),g=y(()=>{var v,h;return f.value!==nt.IDLE?ot("loadingEllipsis",wp.i18n.__("Loading...","woocommerce-wholesale-order-form")):((h=(v=c.value)==null?void 0:v.options)==null?void 0:h.placeholder)||ot("selectCategory",wp.i18n.__("Select Category","woocommerce-wholesale-order-form"))}),S=ye(!0),x=y(()=>Y().settings.includedCategories.length>0||S.value&&Y().internal.categories.include.length>0);r(()=>{S.value=!1}),a(()=>{S.value=!1}),t(()=>{S.value=!1});const k=y(()=>{let v=[{label:g.value,id:"",value:"",parent:0,menu_order:-1}];return S.value&&Y().internal.categories.include.length>0?(v=Y().internal.categories.include.reduce((h,l)=>{const m=We().context==="edit"?"[ID: ".concat(l.id,"] ").concat(l.name):l.name;return h.push({label:m,id:l.id,value:l.id,parent:l.parent,menu_order:l.menu_order}),h},[]),v=window.lodash.sortBy(v,"menu_order")):Y().settings.includedCategories.length>0?(v=[...n.value.data.reduce((h,l)=>{if(Y().settings.includedCategories.length>0&&!Y().settings.includedCategories.includes(l.id))return h;const m=We().context==="edit"?"[ID: ".concat(l.id,"] ").concat(l.name):l.name;return h.push({label:m,id:l.id,value:l.id,parent:l.parent,menu_order:l.menu_order}),h},[])],v=window.lodash.sortBy(v,"menu_order")):(v=[...v,...n.value.data.reduce((h,l)=>{if(Y().settings.excludedCategories.length>0&&Y().settings.excludedCategories.includes(l.id))return h;const m=We().context==="edit"?"[ID: ".concat(l.id,"] ").concat(l.name):l.name;return h.push({label:m,id:l.id,value:l.id,parent:l.parent,menu_order:l.menu_order}),h},[])],v.length>1&&(v=Ct(v))),$t("wwof_category_filter_options",v,e.sectionName,e.rowId,e.columnId,e.fieldId)});Ot(()=>{i.getWcCategories().then(()=>{let{totalPages:v,currentPage:h}=n.value;for(;h<v;)++h,i.getWcCategories({page:h})})});const I=v=>{var h,l;u.value=n.value.data.find(m=>m.id===Number(v)),((l=(h=c.value)==null?void 0:h.options)==null?void 0:l.submitOnChange)==="yes"&&o(u.value)},T=v=>{const h=v.target;if(h.scrollTop+h.offsetHeight===h.scrollHeight){const l=n.value.currentPage+1;if(l>n.value.totalPages)return;i.getWcCategories({page:l})}},A=(v,h)=>h.label.toLowerCase().indexOf(v.toLowerCase())>=0,K=Ue.Option;return(v,h)=>{var l,m;return de(),tt("div",{class:"category-filter-box",style:je(H(Mt)(v.sectionName,v.rowId,v.columnId,v.fieldId))},[H(f)!==H(nt).IDLE?(de(),be(H(Ue),{key:0,value:"",options:[{label:"Loading...",value:""}]})):x.value?(de(),be(H(Ue),{key:1,value:((l=H(u))==null?void 0:l.id)||"","allow-clear":!0,placeholder:g.value,style:je(s.value),"get-popup-container":H(rt),class:"wwof-category-filter",onChange:I,onPopupScroll:T},{default:Re(()=>[U(H(K),{value:""},{default:Re(()=>[lt(at(g.value),1)]),_:1}),(de(!0),tt(_t,null,Ft(k.value,N=>(de(),be(H(K),{key:N.value,value:N.value},{default:Re(()=>[lt(at(N.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value","placeholder","style","get-popup-container"])):(de(),be(H(ft),{key:2,class:"wwof-category-filter",value:((m=H(u))==null?void 0:m.id)||"","allow-clear":!0,"show-search":!0,style:je(s.value),placeholder:g.value,"search-placeholder":g.value,"dropdown-style":{overflowY:"scroll"},"list-height":300,"tree-data":k.value,"show-checked-strategy":H(ft).SHOW_PARENT,"get-popup-container":H(rt),"filter-tree-node":A,onChange:I},null,8,["value","style","placeholder","search-placeholder","tree-data","show-checked-strategy","get-popup-container"]))],4)}}}),ga=cl(Ol,[["__scopeId","data-v-8ee5c472"]]);export{ga as default};
